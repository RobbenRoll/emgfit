

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>emgfit API docs &mdash; emgfit 0.3.4 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/jupyter-sphinx.css" type="text/css" />
  <link rel="stylesheet" href="_static/thebelab.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release History" href="release-history.html" />
    <link rel="prev" title="Central concepts" href="concepts.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> emgfit
          

          
          </a>

          
            
            
              <div class="version">
                0.3.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Getting started with emgfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="emgfit_tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Central concepts</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">emgfit API docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#emgfit-ame-funcs-module">emgfit.ame_funcs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#emgfit-config-module">emgfit.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#emgfit-emg-funcs-module">emgfit.emg_funcs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#emgfit-fit-models-module">emgfit.fit_models module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#emgfit-sample-module">emgfit.sample module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#emgfit-spectrum-module">emgfit.spectrum module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release-history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">emgfit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>emgfit API docs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/modules.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="emgfit-api-docs">
<h1>emgfit API docs<a class="headerlink" href="#emgfit-api-docs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="emgfit-ame-funcs-module">
<h2>emgfit.ame_funcs module<a class="headerlink" href="#emgfit-ame-funcs-module" title="Permalink to this headline">¶</a></h2>
<p>Module for importing and handling of literature mass values from the Atomic Mass
Evaluation 2016 (AME2016).</p>
<span class="target" id="module-emgfit.ame_funcs"></span><dl class="py function">
<dt id="emgfit.ame_funcs.get_AME_values">
<code class="sig-prename descclassname">emgfit.ame_funcs.</code><code class="sig-name descname">get_AME_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">species</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/ame_funcs.html#get_AME_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.ame_funcs.get_AME_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the AME mass, AME mass error, the extrapolation flag and the
mass number A of the given species.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – string with name of species to grab AME for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List containing relevant AME data for <cite>species</cite>:
[AME mass, AME mass uncertainty, <code class="docutils literal notranslate"><span class="pre">True</span></code> if extrapolated species, atomic mass number]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of [<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a>,<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a>,<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a>,<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.ame_funcs.get_El_from_Z">
<code class="sig-prename descclassname">emgfit.ame_funcs.</code><code class="sig-name descname">get_El_from_Z</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Z</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/ame_funcs.html#get_El_from_Z"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.ame_funcs.get_El_from_Z" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to grab element symbol from given proton number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>array-like of int</em>) – Proton number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Symbol of element with specified proton number.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.ame_funcs.mdata_AME">
<code class="sig-prename descclassname">emgfit.ame_funcs.</code><code class="sig-name descname">mdata_AME</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">El</span></em>, <em class="sig-param"><span class="n">A</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/ame_funcs.html#mdata_AME"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.ame_funcs.mdata_AME" title="Permalink to this definition">¶</a></dt>
<dd><p>Grabs atomic mass data from AME2016 [u].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>El</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – String with element symbol.</p></li>
<li><p><strong>A</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Mass number of isotope of interest.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[Element, Z, A, atomic AME mass, atomic AME mass error, boolean flag for extrapolated AME mass]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>,<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a>,<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a>,<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a>,<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.ame_funcs.splitparticle">
<code class="sig-prename descclassname">emgfit.ame_funcs.</code><code class="sig-name descname">splitparticle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/ame_funcs.html#splitparticle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.ame_funcs.splitparticle" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts number, particle/element type and mass number of particle string
(e.g. 1Cs133, Cs133, 1e).</p>
</dd></dl>

<dl class="py function">
<dt id="emgfit.ame_funcs.splitspecies">
<code class="sig-prename descclassname">emgfit.ame_funcs.</code><code class="sig-name descname">splitspecies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/ame_funcs.html#splitspecies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.ame_funcs.splitspecies" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits ion species string into list of constituent atom strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Input species string.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of constituent atom strings contained in <cite>s</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p><code class="docutils literal notranslate"><span class="pre">splitspecies('4H1:1C12')</span></code> returns <code class="docutils literal notranslate"><span class="pre">['4H1','1C12']</span></code>
<code class="docutils literal notranslate"><span class="pre">splitspecies('H1:O16')</span></code> returns <code class="docutils literal notranslate"><span class="pre">['H1','O16']</span></code></p>
</dd></dl>

</div>
<div class="section" id="emgfit-config-module">
<h2>emgfit.config module<a class="headerlink" href="#emgfit-config-module" title="Permalink to this headline">¶</a></h2>
<p>Configuration file with general settings for emgfit package.</p>
<span class="target" id="module-emgfit.config"></span></div>
<div class="section" id="emgfit-emg-funcs-module">
<h2>emgfit.emg_funcs module<a class="headerlink" href="#emgfit-emg-funcs-module" title="Permalink to this headline">¶</a></h2>
<p>Module with numerically robust implementation of the hyper-exponentially-
modified Gaussian probability density function.</p>
<span class="target" id="module-emgfit.emg_funcs"></span><dl class="py function">
<dt id="emgfit.emg_funcs.h_emg">
<code class="sig-prename descclassname">emgfit.emg_funcs.</code><code class="sig-name descname">h_emg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">li_eta_m</span></em>, <em class="sig-param"><span class="n">li_tau_m</span></em>, <em class="sig-param"><span class="n">li_eta_p</span></em>, <em class="sig-param"><span class="n">li_tau_p</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/emg_funcs.html#h_emg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.emg_funcs.h_emg" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-exponentially-modified Gaussian distribution (hyper-EMG).</p>
<p>The lengths of <cite>li_eta_m</cite> &amp; <cite>li_tau_m</cite> must match and define the order of
negative tails. Likewise, the lengths of <cite>li_eta_p</cite> &amp; <cite>li_tau_p</cite> must match
and define the order of positive tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float &gt;= 0</em>) – Abscissa data (mass data).</p></li>
<li><p><strong>mu</strong> (<em>float &gt;= 0</em>) – Mean value of underlying Gaussian distribution.</p></li>
<li><p><strong>sigma</strong> (<em>float &gt;= 0</em>) – Standard deviation of underlying Gaussian distribution.</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>0 &lt;= theta &lt;= 1</em>) – Left-right-weight factor (negative-skewed EMG weight: theta;
positive-skewed EMG weight: 1 - theta).</p></li>
<li><p><strong>li_eta_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the neg. tail weights with the signature:
<code class="docutils literal notranslate"><span class="pre">(eta_m1,</span> <span class="pre">eta_m2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_tau_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the neg. tail decay constants with the signature:
<code class="docutils literal notranslate"><span class="pre">(tau_m1,</span> <span class="pre">tau_m2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_eta_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the pos. tail weights with the signature:
<code class="docutils literal notranslate"><span class="pre">(eta_p1,</span> <span class="pre">eta_p2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_tau_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the pos. tail decay constants with the signature:
<code class="docutils literal notranslate"><span class="pre">(tau_p1,</span> <span class="pre">tau_p2,</span> <span class="pre">...)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ordinate of hyper-EMG distribution</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.emg_funcs.h_m_emg" title="emgfit.emg_funcs.h_m_emg"><code class="xref py py-func docutils literal notranslate"><span class="pre">h_m_emg()</span></code></a>, <a class="reference internal" href="#emgfit.emg_funcs.h_p_emg" title="emgfit.emg_funcs.h_p_emg"><code class="xref py py-func docutils literal notranslate"><span class="pre">h_p_emg()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>The Hyper-EMG probability distribution function was first introduced in
<a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S1387380616302913">this publication</a> by Purushothaman et al. <a class="footnote-reference brackets" href="#id2" id="id1">3</a>. The basic definitions and
notations used here are adapted from this work.</p>
<p>The total hyper-EMG distribution <cite>h_m_emg</cite> is comprised of the negative- and
positive-skewed EMG distributions <cite>h_m_emg</cite> and <cite>h_p_emg</cite> respectively and
is calculated as:
<code class="docutils literal notranslate"><span class="pre">h_emg(x,</span> <span class="pre">mu,</span> <span class="pre">sigma,</span> <span class="pre">theta,</span> <span class="pre">li_eta_m,</span> <span class="pre">li_tau_m,</span> <span class="pre">li_eta_p,</span> <span class="pre">li_tau_p)</span> <span class="pre">=</span></code>
<code class="docutils literal notranslate"><span class="pre">theta*h_m_emg(x,</span> <span class="pre">mu,</span> <span class="pre">sigma,</span> <span class="pre">li_eta_m,</span> <span class="pre">li_tau_m)</span> <span class="pre">+</span>
<span class="pre">(1-theta)*h_p_emg(x,</span> <span class="pre">mu,</span> <span class="pre">sigma,</span> <span class="pre">li_eta_p,</span> <span class="pre">li_tau_p)</span></code>.</p>
<p>For algorithmic details, see <cite>Notes</cite> of <a class="reference internal" href="#emgfit.emg_funcs.h_m_emg" title="emgfit.emg_funcs.h_m_emg"><code class="xref py py-func docutils literal notranslate"><span class="pre">h_m_emg()</span></code></a> and <a class="reference internal" href="#emgfit.emg_funcs.h_p_emg" title="emgfit.emg_funcs.h_p_emg"><code class="xref py py-func docutils literal notranslate"><span class="pre">h_p_emg()</span></code></a>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">3</a></span></dt>
<dd><p>Purushothaman, S., et al. “Hyper-EMG: A new probability distribution
function composed of Exponentially Modified Gaussian distributions to
analyze asymmetric peak shapes in high-resolution time-of-flight mass
spectrometry.” International Journal of Mass Spectrometry 421 (2017):
245-254.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.emg_funcs.h_m_emg">
<code class="sig-prename descclassname">emgfit.emg_funcs.</code><code class="sig-name descname">h_m_emg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">li_eta_m</span></em>, <em class="sig-param"><span class="n">li_tau_m</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/emg_funcs.html#h_m_emg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.emg_funcs.h_m_emg" title="Permalink to this definition">¶</a></dt>
<dd><p>Negative skewed exponentially-modified Gaussian (EMG) distribution.</p>
<p>The lengths of <cite>li_eta_m</cite> &amp; <cite>li_tau_m</cite> must match and define the order of
negative tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float &gt;= 0</em>) – Abscissa data (mass data).</p></li>
<li><p><strong>mu</strong> (<em>float &gt;= 0</em>) – Mean value of underlying Gaussian distribution.</p></li>
<li><p><strong>sigma</strong> (<em>float &gt;= 0</em>) – Standard deviation of underlying Gaussian distribution.</p></li>
<li><p><strong>li_eta_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the neg. tail weights with the signature:
<code class="docutils literal notranslate"><span class="pre">(eta_m1,</span> <span class="pre">eta_m2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_tau_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the neg. tail decay constants with the signature:
<code class="docutils literal notranslate"><span class="pre">(tau_m1,</span> <span class="pre">tau_m2,</span> <span class="pre">...)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ordinate values of the negative skewed EMG distribution.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Hyper-EMG probability distribution function was first introduced in
<a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S1387380616302913">this publication</a> by Purushothaman et al. <a class="footnote-reference brackets" href="#id5" id="id3">4</a>. The basic definitions and
notations used here are adapted from this work.</p>
<p>Each negative tail of a Hyper-EMG function can be expressed in two
equivalent ways:</p>
<div class="math notranslate nohighlight">
\[h_\mathrm{emg,-i} = \frac{\eta_{-i}}{2\tau_{-i}} \exp{(-\left(\frac{x-\mu}{\sqrt{2}\sigma}\right)^2)} \mathrm{erfcx}(v)
= \frac{\eta_{-i}}{2\tau_{-i}} \exp{(u)} \mathrm{erfc}(v),\]</div>
<p>where <span class="math notranslate nohighlight">\(u = \frac{\sigma}{\sqrt{2}\tau_{-i}} + \frac{x-\mu}{\sqrt{2}\tau_{-i}}\)</span>
and <span class="math notranslate nohighlight">\(v = \frac{\sigma}{\sqrt{2}\tau_{-i}} + \frac{x-\mu}{\sqrt{2}\sigma}\)</span>.
In double float precision, the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.exp.html#numpy.exp">exp(u)</a> routine overflows if u &gt; 709.78. The
complementary error function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.erfc.html">erfc(v)</a> underflows to 0.0 if v &gt; 26.54. The
scaled complementary error function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.erfcx.html">erfcx(v)</a> overflows if v &lt; -26.62. To
circumvent those scenarios and always ensure an exact result, the underlying
helper function for the calculation of a negative EMG tail <a class="reference internal" href="#emgfit.emg_funcs.h_m_i" title="emgfit.emg_funcs.h_m_i"><code class="xref py py-func docutils literal notranslate"><span class="pre">h_m_i()</span></code></a>
uses the formulation in terms of <cite>erfcx</cite> whenever v &gt;= 0 and switches to the
<cite>erfc</cite>-formulation when v &lt; 0.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id3">4</a></span></dt>
<dd><p>Purushothaman, S., et al. “Hyper-EMG: A new probability distribution
function composed of Exponentially Modified Gaussian distributions to
analyze asymmetric peak shapes in high-resolution time-of-flight mass
spectrometry.” International Journal of Mass Spectrometry 421 (2017):
245-254.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.emg_funcs.h_m_i">
<code class="sig-prename descclassname">emgfit.emg_funcs.</code><code class="sig-name descname">h_m_i</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">eta_m</span></em>, <em class="sig-param"><span class="n">tau_m</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/emg_funcs.html#h_m_i"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.emg_funcs.h_m_i" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal helper function to calculate single negative EMG tail for
h_m_emg.</p>
</dd></dl>

<dl class="py function">
<dt id="emgfit.emg_funcs.h_m_i_prec">
<code class="sig-prename descclassname">emgfit.emg_funcs.</code><code class="sig-name descname">h_m_i_prec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">eta_m</span></em>, <em class="sig-param"><span class="n">tau_m</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/emg_funcs.html#h_m_i_prec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.emg_funcs.h_m_i_prec" title="Permalink to this definition">¶</a></dt>
<dd><p>Arbitrary precision version of internal helper function for h_m_emg.</p>
</dd></dl>

<dl class="py function">
<dt id="emgfit.emg_funcs.h_p_emg">
<code class="sig-prename descclassname">emgfit.emg_funcs.</code><code class="sig-name descname">h_p_emg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">li_eta_p</span></em>, <em class="sig-param"><span class="n">li_tau_p</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/emg_funcs.html#h_p_emg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.emg_funcs.h_p_emg" title="Permalink to this definition">¶</a></dt>
<dd><p>Positive skewed exponentially-modified Gaussian (EMG) distribution.</p>
<p>The lengths of <cite>li_eta_p</cite> &amp; <cite>li_tau_p</cite> must match and define the order of
positive tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float &gt;= 0</em>) – Abscissa data (mass data).</p></li>
<li><p><strong>mu</strong> (<em>float &gt;= 0</em>) – Mean value of underlying Gaussian distribution.</p></li>
<li><p><strong>sigma</strong> (<em>float &gt;= 0</em>) – Standard deviation of underlying Gaussian distribution.</p></li>
<li><p><strong>li_eta_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the pos. tail weights with the signature:
<code class="docutils literal notranslate"><span class="pre">(eta_p1,</span> <span class="pre">eta_p2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_tau_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the pos. tail decay constants with the signature:
<code class="docutils literal notranslate"><span class="pre">(tau_p1,</span> <span class="pre">tau_p2,</span> <span class="pre">...)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ordinate values of the positive skewed EMG distribution.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Hyper-EMG probability distribution function was first introduced in
<a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S1387380616302913">this publication</a> by Purushothaman et al. <a class="footnote-reference brackets" href="#id11" id="id6">5</a>. The basic definitions and
notations used here are adapted from this work.</p>
<p>Each positive tail of a Hyper-EMG function can be expressed in two
equivalent ways:</p>
<div class="math notranslate nohighlight">
\[h_\mathrm{emg,+i} = \frac{\eta_{+i}}{2\tau_{+i}} \exp{(-\left(\frac{x-\mu}{\sqrt{2}\sigma}\right)^2)} \mathrm{erfcx}(v)
= \frac{\eta_{+i}}{2\tau_{+i}} \exp{(u)} \mathrm{erfc}(v),\]</div>
<p>where <span class="math notranslate nohighlight">\(u = \frac{\sigma}{\sqrt{2}\tau_{+i}} - \frac{x-\mu}{\sqrt{2}\tau_{+i}}\)</span>
and <span class="math notranslate nohighlight">\(v = \frac{\sigma}{\sqrt{2}\tau_{+i}} - \frac{x-\mu}{\sqrt{2}\sigma}\)</span>.
In double precision, the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.exp.html#numpy.exp">exp(u)</a> routine overflows if u &gt; 709.78. The
complementary error function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.erfc.html">erfc(v)</a> underflows to 0.0 if v &gt; 26.54. The
scaled complementary error function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.erfcx.html">erfcx(v)</a> overflows if v &lt; -26.62. To
circumvent those scenarios and always ensure an exact result, the underlying
helper function for the calculation of a negative EMG tail <a class="reference internal" href="#emgfit.emg_funcs.h_m_i" title="emgfit.emg_funcs.h_m_i"><code class="xref py py-func docutils literal notranslate"><span class="pre">h_m_i()</span></code></a>
uses the formulation in terms of <cite>erfcx</cite> whenever v &gt;= 0 and switches to the
<cite>erfc</cite>-formulation when v &lt; 0.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id11"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>Purushothaman, S., et al. “Hyper-EMG: A new probability distribution
function composed of Exponentially Modified Gaussian distributions to
analyze asymmetric peak shapes in high-resolution time-of-flight mass
spectrometry.” International Journal of Mass Spectrometry 421 (2017):
245-254.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.emg_funcs.h_p_i">
<code class="sig-prename descclassname">emgfit.emg_funcs.</code><code class="sig-name descname">h_p_i</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">eta_p</span></em>, <em class="sig-param"><span class="n">tau_p</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/emg_funcs.html#h_p_i"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.emg_funcs.h_p_i" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal helper function to calculate single positive EMG tail for
h_p_emg.</p>
</dd></dl>

<dl class="py function">
<dt id="emgfit.emg_funcs.h_p_i_prec">
<code class="sig-prename descclassname">emgfit.emg_funcs.</code><code class="sig-name descname">h_p_i_prec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">eta_p</span></em>, <em class="sig-param"><span class="n">tau_p</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/emg_funcs.html#h_p_i_prec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.emg_funcs.h_p_i_prec" title="Permalink to this definition">¶</a></dt>
<dd><p>Arbitrary precision version of internal helper function for h_p_emg.</p>
</dd></dl>

<dl class="py function">
<dt id="emgfit.emg_funcs.mu_emg">
<code class="sig-prename descclassname">emgfit.emg_funcs.</code><code class="sig-name descname">mu_emg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">li_eta_m</span></em>, <em class="sig-param"><span class="n">li_tau_m</span></em>, <em class="sig-param"><span class="n">li_eta_p</span></em>, <em class="sig-param"><span class="n">li_tau_p</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/emg_funcs.html#mu_emg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.emg_funcs.mu_emg" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate mean of hyper-EMG distribution.</p>
<p>The lengths of <cite>li_eta_m</cite> &amp; <cite>li_tau_m</cite> must match and define the order of
negative tails. Likewise, the lengths of <cite>li_eta_p</cite> &amp; <cite>li_tau_p</cite> must match
and define the order of positive tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>float &gt;= 0</em>) – Mean value of underlying Gaussian distribution.</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>0 &lt;= theta &lt;= 1</em>) – Left-right-weight factor (negative-skewed EMG weight: theta;
positive-skewed EMG weight: 1 - theta).</p></li>
<li><p><strong>li_eta_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the neg. tail weights with the signature:
<code class="docutils literal notranslate"><span class="pre">(eta_m1,</span> <span class="pre">eta_m2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_tau_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the neg. tail decay constants with the signature:
<code class="docutils literal notranslate"><span class="pre">(tau_m1,</span> <span class="pre">tau_m2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_eta_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the pos. tail weights with the signature:
<code class="docutils literal notranslate"><span class="pre">(eta_p1,</span> <span class="pre">eta_p2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_tau_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the pos. tail decay constants with the signature:
<code class="docutils literal notranslate"><span class="pre">(tau_p1,</span> <span class="pre">tau_p2,</span> <span class="pre">...)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mean of hyper-EMG distribution.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Hyper-EMG probability distribution function was first introduced in
<a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S1387380616302913">this publication</a> by Purushothaman et al. <a class="footnote-reference brackets" href="#id14" id="id12">6</a>. The basic definitions and
notations used here are adapted from this work.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id12">6</a></span></dt>
<dd><p>Purushothaman, S., et al. “Hyper-EMG: A new probability distribution
function composed of Exponentially Modified Gaussian distributions to
analyze asymmetric peak shapes in high-resolution time-of-flight mass
spectrometry.” International Journal of Mass Spectrometry 421 (2017):
245-254.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.emg_funcs.sigma_emg">
<code class="sig-prename descclassname">emgfit.emg_funcs.</code><code class="sig-name descname">sigma_emg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">li_eta_m</span></em>, <em class="sig-param"><span class="n">li_tau_m</span></em>, <em class="sig-param"><span class="n">li_eta_p</span></em>, <em class="sig-param"><span class="n">li_tau_p</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/emg_funcs.html#sigma_emg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.emg_funcs.sigma_emg" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate standard deviation of hyper-EMG distribution.</p>
<p>The lengths of <cite>li_eta_m</cite> &amp; <cite>li_tau_m</cite> must match and define the order of
negative tails. Likewise, the lengths of <cite>li_eta_p</cite> &amp; <cite>li_tau_p</cite> must match
and define the order of positive tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<em>float &gt;= 0</em>) – Standard deviation of underlying Gaussian distribution.</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>0 &lt;= theta &lt;= 1</em>) – Left-right-weight factor (negative-skewed EMG weight: theta;
positive-skewed EMG weight: 1 - theta).</p></li>
<li><p><strong>li_eta_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the neg. tail weights with the signature:
<code class="docutils literal notranslate"><span class="pre">(eta_m1,</span> <span class="pre">eta_m2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_tau_m</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the neg. tail decay constants with the signature:
<code class="docutils literal notranslate"><span class="pre">(tau_m1,</span> <span class="pre">tau_m2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_eta_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the pos. tail weights with the signature:
<code class="docutils literal notranslate"><span class="pre">(eta_p1,</span> <span class="pre">eta_p2,</span> <span class="pre">...)</span></code>.</p></li>
<li><p><strong>li_tau_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple containing the pos. tail decay constants with the signature:
<code class="docutils literal notranslate"><span class="pre">(tau_p1,</span> <span class="pre">tau_p2,</span> <span class="pre">...)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Standard deviation of hyper-EMG distribution.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Hyper-EMG probability distribution function was first introduced in
<a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S1387380616302913">this publication</a> by Purushothaman et al. <a class="footnote-reference brackets" href="#id17" id="id15">7</a>. The basic definitions and
notations used here are adapted from this work.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id17"><span class="brackets"><a class="fn-backref" href="#id15">7</a></span></dt>
<dd><p>Purushothaman, S., et al. “Hyper-EMG: A new probability distribution
function composed of Exponentially Modified Gaussian distributions to
analyze asymmetric peak shapes in high-resolution time-of-flight mass
spectrometry.” International Journal of Mass Spectrometry 421 (2017):
245-254.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="emgfit-fit-models-module">
<h2>emgfit.fit_models module<a class="headerlink" href="#emgfit-fit-models-module" title="Permalink to this headline">¶</a></h2>
<p>Module with lmfit models for single peaks with Gaussian or various
hyper-exponentially-modified Gaussian line shapes.</p>
<span class="target" id="module-emgfit.fit_models"></span><dl class="py function">
<dt id="emgfit.fit_models.Gaussian">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">Gaussian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#Gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.Gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian lmfit model (single-peak Gaussian fit model)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.create_default_init_pars">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">create_default_init_pars</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mass_number</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#create_default_init_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.create_default_init_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale default parameters to mass of interest and return parameter dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mass_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Atomic mass number of peaks of interest, defaults to 100.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with default initial parameters (scaled to <cite>mass_number</cite>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>The default parameters were defined for mass 100</strong>, to obtain suitable
parameters at other masses all mass-dependent parameters (i.e. shape
parameters &amp; <cite>amp</cite>) are multiplied by the scaling factor <cite>mass_number</cite>/100.</p>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.emg01">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">emg01</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#emg01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.emg01" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-EMG(0,1) lmfit model (single-peak fit model with one exponential tail
on the right)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.emg10">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">emg10</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#emg10"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.emg10" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-EMG(1,0) lmfit model (single-peak fit model with one exponential tail
on the left)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.emg11">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">emg11</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#emg11"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.emg11" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-EMG(1,1) lmfit model (single-peak fit model with one exponential tail
on the left and one exponential tail on the right)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.emg12">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">emg12</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#emg12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.emg12" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-EMG(1,2) lmfit model (single-peak fit model with one exponential tail
on the left and two exponential tails on the right)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.emg21">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">emg21</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#emg21"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.emg21" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-EMG(2,1) lmfit model (single-peak fit model with two exponential tails
on the left and one exponential tail on the right)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.emg22">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">emg22</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#emg22"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.emg22" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-EMG(2,2) lmfit model (single-peak fit model with two exponential tails
on the left and two exponential tails on the right)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.emg23">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">emg23</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#emg23"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.emg23" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-EMG(2,3) lmfit model (single-peak fit model with two exponential tails
on the left and three exponential tails on the right)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.emg32">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">emg32</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#emg32"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.emg32" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-EMG(3,2) lmfit model (single-peak fit model with three exponential
tails on the left and two exponential tails on the right)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.fit_models.emg33">
<code class="sig-prename descclassname">emgfit.fit_models.</code><code class="sig-name descname">emg33</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">{'amp': 0.45, 'eta_m1': 0.85, 'eta_m2': 0.1, 'eta_m3': 0.05, 'eta_p1': 0.85, 'eta_p2': 0.1, 'eta_p3': 0.05, 'mu': None, 'sigma': 0.00014, 'tau_m1': 5e-05, 'tau_m2': 0.0005, 'tau_m3': 0.001, 'tau_p1': 5e-05, 'tau_p2': 0.0006, 'tau_p3': 0.001, 'theta': 0.5}</span></em>, <em class="sig-param"><span class="n">vary_shape_pars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/fit_models.html#emg33"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.fit_models.emg33" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyper-EMG(3,3) lmfit model (single-peak fit model with three exponential
tails on the left and three exponential tails on the right)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak to fit.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak centroid.</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Initial guess of peak amplitude.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Initial parameters for fit (‘amp’ and ‘mu’ parameters in <cite>init_pars</cite>
dictionary are overwritten by the given <cite>amp</cite> and <cite>x_pos</cite> arguments)</p></li>
<li><p><strong>vary_shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether to vary or fix peak shape parameters (i.e. sigma, theta,
eta’s and tau’s).</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of the first peak to be fit in a multi-peak-fit. Only use this
during peak shape determination to enforce common shape parameters
for all peaks to be fitted. (For a regular fit with
<code class="docutils literal notranslate"><span class="pre">vary_shape_pars</span> <span class="pre">=</span> <span class="pre">False</span></code> this is irrelevant.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>lmfit</cite> model object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="emgfit-sample-module">
<h2>emgfit.sample module<a class="headerlink" href="#emgfit-sample-module" title="Permalink to this headline">¶</a></h2>
<p>Module for creating simulated time-of-flight mass spectra with Gaussian and
hyper-exponentially-modified line shapes.</p>
<span class="target" id="module-emgfit.sample"></span><dl class="py function">
<dt id="emgfit.sample._h_m_i_rvs">
<code class="sig-prename descclassname">emgfit.sample.</code><code class="sig-name descname">_h_m_i_rvs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">tau_m</span></em>, <em class="sig-param"><span class="n">N_i</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/sample.html#_h_m_i_rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.sample._h_m_i_rvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for definition of h_m_emg_rvs</p>
</dd></dl>

<dl class="py function">
<dt id="emgfit.sample._h_p_i_rvs">
<code class="sig-prename descclassname">emgfit.sample.</code><code class="sig-name descname">_h_p_i_rvs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">tau_p</span></em>, <em class="sig-param"><span class="n">N_i</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/sample.html#_h_p_i_rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.sample._h_p_i_rvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for definition of h_p_emg_rvs</p>
</dd></dl>

<dl class="py function">
<dt id="emgfit.sample.h_emg_rvs">
<code class="sig-prename descclassname">emgfit.sample.</code><code class="sig-name descname">h_emg_rvs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">t_args</span></em>, <em class="sig-param"><span class="n">N_samples</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/sample.html#h_emg_rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.sample.h_emg_rvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw random samples from Hyper-EMG PDF</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Nominal position of simulated peak (mean of underlying Gaussian).</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Nominal standard deviation (of the underlying Gaussian) of the simulated
hyper-EMG peak.</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Mixing weight of pos. &amp; neg. skewed EMG distributions.</p></li>
<li><p><strong>t_args</strong> (<em>list of lists of float</em>) – List containing lists of the EMG tail parameters with the signature:
[[eta_m1, eta_m2, …], [tau_m1, tau_m2, …],
[eta_p1, eta_p2, …], [tau_p1, tau_p2, …]]</p></li>
<li><p><strong>N_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of random events to sample.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array with simulated events.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.sample.h_m_emg_rvs">
<code class="sig-prename descclassname">emgfit.sample.</code><code class="sig-name descname">h_m_emg_rvs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">t_args</span></em>, <em class="sig-param"><span class="n">N_samples</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/sample.html#h_m_emg_rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.sample.h_m_emg_rvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw random samples from neg. skewed Hyper-EMG PDF</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Nominal position of simulated peak (mean of underlying Gaussian).</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Nominal standard deviation (of the underlying Gaussian) of the simulated
hyper-EMG peak.</p></li>
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Mixing weight of pos. &amp; neg. skewed EMG distributions.</p></li>
<li><p><strong>t_args</strong> (<em>list of lists of float</em>) – List containing lists of the EMG tail parameters with the signature:
[[eta_m1, eta_m2, …], [tau_m1, tau_m2, …]]</p></li>
<li><p><strong>N_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of random events to sample.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array with simulated events.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.sample.h_p_emg_rvs">
<code class="sig-prename descclassname">emgfit.sample.</code><code class="sig-name descname">h_p_emg_rvs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">t_args</span></em>, <em class="sig-param"><span class="n">N_samples</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/sample.html#h_p_emg_rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.sample.h_p_emg_rvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw random samples from pos. skewed Hyper-EMG PDF</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Nominal position of simulated peak (mean of underlying Gaussian).</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Nominal standard deviation (of the underlying Gaussian) of the simulated
hyper-EMG peak.</p></li>
<li><p><strong>t_args</strong> (<em>list of lists of float</em>) – List containing lists of the EMG tail parameters with the signature:
[[eta_p1, eta_p2, …], [tau_p1, tau_p2, …]]</p></li>
<li><p><strong>N_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of random events to sample.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array with simulated events.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="emgfit.sample.simulate_events">
<code class="sig-prename descclassname">emgfit.sample.</code><code class="sig-name descname">simulate_events</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shape_pars</span></em>, <em class="sig-param"><span class="n">mus</span></em>, <em class="sig-param"><span class="n">amps</span></em>, <em class="sig-param"><span class="n">bkg_c</span></em>, <em class="sig-param"><span class="n">N_events</span></em>, <em class="sig-param"><span class="n">x_min</span></em>, <em class="sig-param"><span class="n">x_max</span></em>, <em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">'hist'</span></em>, <em class="sig-param"><span class="n">N_bins</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bin_cens</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/sample.html#simulate_events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.sample.simulate_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Create simulated ion events drawn from a user-defined probability
distribution function (PDF)</p>
<p>Events can either be output as a list of single events (mass stamps) or as a
histogram. In histogram output mode, uniform binning is easily realized by
specifying the <cite>N_bins</cite> argument. More control over the binning can be
achieved by parsing the desired bin centers to the <cite>bin_cens</cite> argument (e.g.
for non-uniform binning).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Peak-shape parameters to use for sampling. The dictionary must follow
the structure of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_cal_pars</span></code> attribute of the
<code class="xref py py-class docutils literal notranslate"><span class="pre">spectrum</span></code> class.</p></li>
<li><p><strong>mus</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><em>list of float</em><em> [</em><em>u</em><em>]</em>) – Nominal peak positions of peaks in simulated spectrum.</p></li>
<li><p><strong>amps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><em>list of float</em><em> [</em><em>counts per u</em><em>]</em>) – Nominal amplitudes of peaks in simulated spectrum.</p></li>
<li><p><strong>bkg_c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>counts per bin</em><em>]</em><em>, </em><em>optional</em><em>, </em><em>default: 0.0</em>) – Nominal amplitude of uniform background in simulated spectrum.</p></li>
<li><p><strong>x_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Beginning of sampling mass range.</p></li>
<li><p><strong>x_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – End of sampling mass range.</p></li>
<li><p><strong>N_events</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em><em>, </em><em>default: 1000</em>) – Total number of events to simulate (signal and background events).</p></li>
<li><p><strong>out</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – <p>Output format of sampled data. Options:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'hist'</span></code> for binned mass spectrum (default). The centres of the mass
bins must be specified with the <cite>bin_cens</cite> argument.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'list'</span></code> for unbinned list of single ion and background events.</p></li>
</ul>
</p></li>
<li><p><strong>N_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of uniform bins to use in <code class="docutils literal notranslate"><span class="pre">'hist'</span></code> output mode. The <strong>outer</strong>
edges of the first and last bin are fixed to the start and end of the
sampling range respectively (i.e. <cite>x_min</cite> and <cite>x_max</cite>). In between, bins
are distributed with a fixed spacing of (<cite>x_max</cite>-<cite>x_min</cite>)/<cite>N_bins</cite>.</p></li>
<li><p><strong>bin_cens</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> [u]) – Centres of mass bins to use in <code class="docutils literal notranslate"><span class="pre">'hist'</span></code> output mode. This argument
allows the realization of non-uniform binning. Bin edges are centred
between neighboring bins. Note: Bins outside the sampling range defined
with <cite>x_min</cite> and <cite>x_max</cite> will be empty.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If out=’hist’ a dataframe with a histogram of the format
[bin centre [u], counts in bin] is returned. If out=’list’ an unbinned
array with mass values [u] of single ion or background events is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.Dataframe</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Random events are created via custom Hyper-EMG extensions of Scipy’s
<code class="xref py py-meth docutils literal notranslate"><span class="pre">scipy.stats.exponnorm.rvs()</span></code> method.</p>
<p>Currently, all simulated peaks have identical width and shape (no re-scaling
of mass-dependent shape parameters to a peak’s mass centroid).</p>
<p>Routine requires tail arguments in shape_cal_pars dict to be ordered
(eta_m1,eta_m2,…) etc..</p>
<p><strong>Mind the different units for peak amplitudes `amps` (counts per u) and the
background level `bkg_c` (counts per bin)</strong>. When spectrum data is
simulated counts are randomly distributed between the different peaks and
the background with probability weights <cite>amps</cite> * &lt;bin width in&gt; and
<cite>bkg_c</cite> * &lt;number of bins&gt;, respectively. As a consequence, simply changing
<cite>N_events</cite> (while keeping all other arguments constant), will cause <cite>amps</cite>
and <cite>bkg_c</cite> to deviate from their nominal units.</p>
</dd></dl>

<dl class="py function">
<dt id="emgfit.sample.simulate_spectrum">
<code class="sig-prename descclassname">emgfit.sample.</code><code class="sig-name descname">simulate_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span></em>, <em class="sig-param"><span class="n">x_cen</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_range</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mus</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">amps</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bkg_c</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">N_events</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">copy_spec</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/sample.html#simulate_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.sample.simulate_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a simulated spectrum using the attributes of a reference spectrum</p>
<p>The peak shape of the sampling probability distribution function (PDF)
follows the shape calibration of the reference spectrum (<cite>spec</cite>). By
default, all other parameters of the sampling PDF are identical to the
best-fit parameters of the reference spectrum. If desired, the positions,
amplitudes and number of peaks in the sampling PDF as well as the background
level can be changed with the <cite>mus</cite>, <cite>amps</cite> and <cite>bkg_c</cite> arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> (<a class="reference internal" href="#emgfit.spectrum.spectrum" title="emgfit.spectrum.spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">spectrum</span></code></a>) – Reference spectrum object whose best-fit parameters will be used to
sample from.</p></li>
<li><p><strong>mus</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><em>list of float</em><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Nominal peak centres of peaks in simulated spectrum. Defaults to the
mus of the reference spectrum fit.</p></li>
<li><p><strong>amps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><em>list of float</em><em> [</em><em>counts per u</em><em>]</em><em>, </em><em>optional</em>) – Nominal amplitudes of peaks in simulated spectrum. Defaults to the
amplitudes of the reference spectrum fit.</p></li>
<li><p><strong>bkg_c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>counts per bin</em><em>]</em><em>, </em><em>optional</em>) – Nominal amplitude of uniform background in simulated spectrum. Defaults
to the c_bkg obtained in the fit of the first peak in the reference
spectrum.</p></li>
<li><p><strong>x_cen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Mass center of simulated spectrum. Defaults to <cite>x_cen</cite> of <cite>spec</cite>.</p></li>
<li><p><strong>x_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Covered mass range of simulated spectrum. Defaults to <cite>x_range</cite> of
<cite>spectrum</cite>.</p></li>
<li><p><strong>N_events</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of ion events to simulate (including background events). Defaults
to total number of events in <cite>spec</cite>.</p></li>
<li><p><strong>copy_spec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default: False</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), this function returns a fresh
<code class="xref py py-class docutils literal notranslate"><span class="pre">spectrum</span></code> object created from the simulated mass data.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, this function returns an exact copy of <cite>spec</cite> with only the
:attr`data` attribute replaced by the new simulated mass data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>copy_spec = False</cite> (default) a fresh spectrum object holding the
simulated mass data is returned. If <cite>copy_spec = True</cite>, a copy of the
reference spectrum <cite>spec</cite> is returned with only the <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code>
attribute replaced by the new simulated mass data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">spectrum.spectrum</span></code></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Random events are created via custom Hyper-EMG extensions of Scipy’s
<code class="xref py py-meth docutils literal notranslate"><span class="pre">scipy.stats.exponnorm.rvs()</span></code> method.</p>
<p>Currently, all simulated peaks have identical width and shape (no re-scaling
of mass-dependent shape parameters to a peak’s mass centroid).</p>
<p>The returned spectrum follows the binning of the reference spectrum.</p>
<p>Mind the different units for peak amplitudes <cite>amps</cite> (counts per u) and the
background level <cite>bkg_c</cite> (counts per bin). When spectrum data is
simulated counts are distributed between the different peaks and the
background with probability weights <cite>amps</cite> * &lt;bin width in&gt; and
<cite>bkg_c</cite> * &lt;number of bins&gt;, respectively. As a consequence, simply changing
<cite>N_events</cite> (while keeping all other arguments constant), will render <cite>amps</cite>
and <cite>bkg_c</cite> away from their nominal units.</p>
</dd></dl>

</div>
<div class="section" id="emgfit-spectrum-module">
<h2>emgfit.spectrum module<a class="headerlink" href="#emgfit-spectrum-module" title="Permalink to this headline">¶</a></h2>
<p>Module for fitting time-of-flight mass spectra.</p>
<span class="target" id="module-emgfit.spectrum"></span><dl class="py class">
<dt id="emgfit.spectrum.peak">
<em class="property">class </em><code class="sig-prename descclassname">emgfit.spectrum.</code><code class="sig-name descname">peak</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">species</span></em>, <em class="sig-param"><span class="n">m_AME</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m_AME_error</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#peak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Object storing all relevant information about a mass peak.</p>
<p>Most peak attributes are intialized as <code class="docutils literal notranslate"><span class="pre">None</span></code> and are later automatically
updated by methods of the spectrum class, e.g.
<a class="reference internal" href="#emgfit.spectrum.spectrum.determine_peak_shape" title="emgfit.spectrum.spectrum.determine_peak_shape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.determine_peak_shape()</span></code></a> or <a class="reference internal" href="#emgfit.spectrum.spectrum.fit_peaks" title="emgfit.spectrum.spectrum.fit_peaks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.fit_peaks()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Coarse position of peak centroid. In fits the Hyper-EMG parameter for
the (Gaussian) peak centroid <cite>mu</cite> will be initialized at this value.
Peak markers in plots are located at <cite>x_pos</cite>.</p></li>
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – String with chemical formula of ion species asociated with peak.
Species strings follow the <a class="reference internal" href="concepts.html#notation"><span class="std std-ref">:-notation of chemical substances</span></a>.
Examples: <code class="docutils literal notranslate"><span class="pre">'1K39:-1e'</span></code>, <code class="docutils literal notranslate"><span class="pre">'K39:-e'</span></code>, <code class="docutils literal notranslate"><span class="pre">'3H1:1O16:-1e'</span></code>.
<strong>Do not forget to substract the electron</strong>, otherwise the atomic not
the ionic mass would be used as literature value!
Alternatively, tentative assigments can be made by adding a <code class="docutils literal notranslate"><span class="pre">'?'</span></code> at
the end of the species string (e.g.: <code class="docutils literal notranslate"><span class="pre">'Sn100:-1e?'</span></code>, <code class="docutils literal notranslate"><span class="pre">'?'</span></code>, …).</p></li>
<li><p><strong>comment</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – User comment for peak.</p></li>
<li><p><strong>m_AME</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Ionic literature mass value, from AME2016 or user-defined.</p></li>
<li><p><strong>m_AME_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Literature mass uncertainty, from AME2016 or user-defined.</p></li>
<li><p><strong>extrapolated</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Boolean flag for extrapolated AME mass values (equivalent to ‘#’ in AME).</p></li>
<li><p><strong>fit_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Name of model used to fit peak.</p></li>
<li><p><strong>cost_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of cost function used to fit peak (<code class="docutils literal notranslate"><span class="pre">'chi-square'</span></code> or <code class="docutils literal notranslate"><span class="pre">'MLE'</span></code>).</p></li>
<li><p><strong>red_chi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Reduced chi-squared of peak fit. If the peak was fitted using <code class="docutils literal notranslate"><span class="pre">'MLE'</span></code>,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">red_chi</span></code> should be taken with caution.</p></li>
<li><p><strong>area_error</strong> (<em>area</em><em>,</em>) – Number of total counts in peak and corresponding uncertainty
(calculated from amplitude parameter <cite>amp</cite> of peak fit).</p></li>
<li><p><strong>m_ion</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Ionic mass value obtained in peak fit (after mass recalibration).</p></li>
<li><p><strong>rel_stat_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Relative statistical uncertainty of <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_ion</span></code>.</p></li>
<li><p><strong>rel_recal_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Relative uncertainty of <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_ion</span></code> due to mass recalibration.</p></li>
<li><p><strong>rel_peakshape_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Relative peak-shape uncertainty of <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_ion</span></code>.</p></li>
<li><p><strong>rel_mass_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Total relative mass uncertainty of <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_ion</span></code> (excluding systematics!).
Includes statistical, peak-shape and recalibration uncertainty.</p></li>
<li><p><strong>A</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Atomic mass number of peak species.</p></li>
<li><p><strong>atomic_ME_keV</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>keV</em><em>]</em>) – (Atomic) mass excess corresponding to <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_ion</span></code>.</p></li>
<li><p><strong>mass_error_keV</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>keV</em><em>]</em>) – Total mass uncertainty of <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_ion</span></code> (excluding systematics!).</p></li>
<li><p><strong>m_dev_keV</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>keV</em><em>]</em>) – Deviation from literature value (<code class="xref py py-attr docutils literal notranslate"><span class="pre">m_ion</span></code> - <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_AME</span></code>).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="emgfit.spectrum.peak.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">species</span></em>, <em class="sig-param"><span class="n">m_AME</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m_AME_error</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#peak.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.peak.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a new <a class="reference internal" href="#emgfit.spectrum.peak" title="emgfit.spectrum.peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">peak</span></code></a> object.</p>
<p>If a valid ion species is assigned with the <cite>species</cite> parameter the
corresponding literature values will automatically be fetched from the
AME2016 database. The syntax for species assignment follows that of MAc
(for more details see documentation for <cite>species</cite> parameter below).</p>
<p>If different literature values are to be used, the literature mass or
mass uncertainty can be user-defined with <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_AME</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">m_AME_error</span></code>. This is useful for isomers and in cases where more
recent measurements haven’t been included in the AME yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Coarse position of peak centroid. In fits the Hyper-EMG parameter
for the (Gaussian) peak centroid <cite>mu</cite> will be initialized at this
value. Peak markers in plots are located at <cite>x_pos</cite>.</p></li>
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – String with chemical formula of ion species asociated with peak.
Species strings follow the <a class="reference internal" href="concepts.html#notation"><span class="std std-ref">:-notation of chemical substances</span></a>.
Examples: <code class="docutils literal notranslate"><span class="pre">'1K39:-1e'</span></code>, <code class="docutils literal notranslate"><span class="pre">'K39:-e'</span></code>, <code class="docutils literal notranslate"><span class="pre">'3H1:1O16:-1e'</span></code>.
<strong>Do not forget to substract the electron from singly-charged
species</strong>, otherwise the atomic not the ionic mass will be used as
literature value! Alternatively, tentative assigments can be made by
adding a <code class="docutils literal notranslate"><span class="pre">'?'</span></code> at the end of the species string
(e.g.: <code class="docutils literal notranslate"><span class="pre">'Sn100:-1e?'</span></code>, <code class="docutils literal notranslate"><span class="pre">'?'</span></code>, …).</p></li>
<li><p><strong>m_AME</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – User-defined literature mass value. Overwrites value fetched from
AME2016. Useful for isomers or to use more up-to-date values.</p></li>
<li><p><strong>m_AME_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – User-defined literature mass uncertainty. Overwrites value fetched
from AME2016.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.peak.print_properties">
<code class="sig-name descname">print_properties</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#peak.print_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.peak.print_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the most relevant peak properties.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.peak.update_lit_values">
<code class="sig-name descname">update_lit_values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#peak.update_lit_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.peak.update_lit_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_AME</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_AME_error</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">extrapolated</span></code>
peak attributes with AME2016 values for specified species.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="emgfit.spectrum.spectrum">
<em class="property">class </em><code class="sig-prename descclassname">emgfit.spectrum.</code><code class="sig-name descname">spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m_start</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m_stop</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">skiprows</span><span class="o">=</span><span class="default_value">18</span></em>, <em class="sig-param"><span class="n">show_plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">df</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Object storing spectrum data, associated peaks and all relevant
fit results - the workhorse of emgfit.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Name of input file containing the spectrum data.</p></li>
<li><p><strong>spectrum_comment</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default: '-'</em>) – User comment for entire spectrum (helpful for further processing after).</p></li>
<li><p><strong>fit_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Name of model used for peak-shape determination and further fitting.</p></li>
<li><p><strong>index_shape_calib</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak used for peak-shape calibration.</p></li>
<li><p><strong>red_chi_shape_cal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Reduced chi-squared of peak-shape determination fit.</p></li>
<li><p><strong>fit_range_shape_cal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Fit range used for peak-shape calibration.</p></li>
<li><p><strong>shape_cal_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>) – Fit result obtained in peak-shape calibration.</p></li>
<li><p><strong>shape_cal_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Model parameter values obtained in peak-shape calibration.</p></li>
<li><p><strong>shape_cal_errors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Model parameter uncertainties obtained in peak-shape calibration.</p></li>
<li><p><strong>index_mass_calib</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Peak index of mass calibrant peak.</p></li>
<li><p><strong>determined_A_stat_emg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Boolean flag for whether <code class="xref py py-attr docutils literal notranslate"><span class="pre">A_stat_emg</span></code> was determined for this
spectrum specifically using the <a class="reference internal" href="#emgfit.spectrum.spectrum.determine_A_stat_emg" title="emgfit.spectrum.spectrum.determine_A_stat_emg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_A_stat_emg()</span></code></a> method.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">A_stat_emg</span></code> was set using
<a class="reference internal" href="#emgfit.spectrum.spectrum.determine_A_stat_emg" title="emgfit.spectrum.spectrum.determine_A_stat_emg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_A_stat_emg()</span></code></a>, otherwise the default value
<cite>emgfit.config.A_stat_emg_default</cite> from the <a class="reference internal" href="#module-emgfit.config" title="emgfit.config"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config</span></code></a> module
was used. For more details see docs of <a class="reference internal" href="#emgfit.spectrum.spectrum.determine_A_stat_emg" title="emgfit.spectrum.spectrum.determine_A_stat_emg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_A_stat_emg()</span></code></a>
method.</p></li>
<li><p><strong>A_stat_emg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Constant of proportionality for calculation of the statistical mass
uncertainties. Defaults to <cite>emgfit.config.A_stat_emg_default</cite>
as defined in the <a class="reference internal" href="#module-emgfit.config" title="emgfit.config"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config</span></code></a> module, unless the
<a class="reference internal" href="#emgfit.spectrum.spectrum.determine_A_stat_emg" title="emgfit.spectrum.spectrum.determine_A_stat_emg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_A_stat_emg()</span></code></a> method is run.</p></li>
<li><p><strong>A_stat_emg_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Uncertainty of <code class="xref py py-attr docutils literal notranslate"><span class="pre">A_stat_emg</span></code>.</p></li>
<li><p><strong>recal_fac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default: 1.0</em>) – Scaling factor applied to <code class="xref py py-attr docutils literal notranslate"><span class="pre">m_ion</span></code> in mass recalibration.</p></li>
<li><p><strong>rel_recal_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Relative uncertainty of recalibration factor <code class="xref py py-attr docutils literal notranslate"><span class="pre">recal_fac</span></code>.</p></li>
<li><p><strong>recal_facs_pm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Modified recalibration factors obtained in peak-shape uncertainty
evaluation by varying each shape parameter by plus and minus 1 standard
deviation, respectively.</p></li>
<li><p><strong>eff_mass_shifts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of dict) – Maximal effective mass shifts for each peak obtained in peak-shape
uncertainty evaluation by varying each shape parameter by plus and minus
1 standard deviation and only keeping the shift with the larger absolute
magnitude. The <cite>eff_mass_shifts</cite> array contains a dictionary for each
peak; the dictionaries have the following structure:
{‘&lt;shape param. name&gt; eff. mass shift’ : [&lt;maximal eff. mass shift&gt;],…}
For more details see docs of <a class="reference internal" href="#emgfit.spectrum.spectrum._eval_peakshape_errors" title="emgfit.spectrum.spectrum._eval_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_eval_peakshape_errors()</span></code></a>.</p></li>
<li><p><strong>area_shifts</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of dict) – Maximal area change for each peak obtained in peak-shape uncertainty
evaluation by varying each shape parameter by plus and minus 1 standard
deviation and only keeping the shift with the larger absolute magnitude.
The <cite>eff_mass_shifts</cite> array contains a dictionary for each peak; the
dictionaries have the following structure:
{‘&lt;shape param. name&gt; eff. mass shift’ : [&lt;maximal eff. mass shift&gt;],…}
For the mass calibrant the dictionary holds the absolute shifts of the
calibrant peak centroid (<cite>calibrant centroid shift</cite>). For more
details see docs of <a class="reference internal" href="#emgfit.spectrum.spectrum._eval_peakshape_errors" title="emgfit.spectrum.spectrum._eval_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_eval_peakshape_errors()</span></code></a>.</p></li>
<li><p><strong>peaks_with_errors_from_resampling</strong> (<em>list of int</em>) – List with indeces of peaks whose statistical mass and area uncertainties
have been determined by fitting synthetic spectra resampled from the
best-fit model (see <a class="reference internal" href="#emgfit.spectrum.spectrum.get_errors_from_resampling" title="emgfit.spectrum.spectrum.get_errors_from_resampling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_errors_from_resampling()</span></code></a>).</p></li>
<li><p><strong>MCMC_par_samples</strong> (<em>list of dict</em>) – Shape parameter samples obtained via Markov chain Monte Carlo (MCMC)
sampling with <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a>.</p></li>
<li><p><strong>MC_recal_facs</strong> (<em>list of float</em>) – Recalibration factors obtained in fits with Markov Chain Monte Carlo
(MCMC) shape parameter samples in <a class="reference internal" href="#emgfit.spectrum.spectrum.get_MC_peakshape_errors" title="emgfit.spectrum.spectrum.get_MC_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_MC_peakshape_errors()</span></code></a>.</p></li>
<li><p><strong>peaks_with_MC_PS_errors</strong> (<em>list of int</em>) – List with indeces of peaks for which peak-shape errors have been
determined by re-fitting with shape parameter sets from Markov Chain
Monte Carlo sampling (see <a class="reference internal" href="#emgfit.spectrum.spectrum.get_MC_peakshape_errors" title="emgfit.spectrum.spectrum.get_MC_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_MC_peakshape_errors()</span></code></a>).</p></li>
<li><p><strong>peaks</strong> (list of <a class="reference internal" href="#emgfit.spectrum.peak" title="emgfit.spectrum.peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">peak</span></code></a>) – List containing all peaks associated with the spectrum sorted by
ascending mass. The index of a peak within the <cite>peaks</cite> list is referred
to as the <code class="docutils literal notranslate"><span class="pre">peak_index</span></code>.</p></li>
<li><p><strong>fit_results</strong> (list of <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>) – List containing fit results (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a> objects)
for peaks associated with spectrum.</p></li>
<li><p><strong>blinded_peaks</strong> (<em>list of int</em>) – List with indeces of peaks whose mass values and peak positions are to
be hidden to enable blind analysis. The mass values will be unblinded
upon export of the analysis results.</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>) – Histogrammed spectrum data.</p></li>
<li><p><strong>mass_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Atomic mass number associated with central bin of spectrum.</p></li>
<li><p><strong>default_fit_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Default mass range for fits, scaled to <code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_number</span></code> of spectrum.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit_model</span></code> spectrum attribute seems somewhat redundant with
the <code class="xref py py-attr docutils literal notranslate"><span class="pre">peak.fit_model</span></code> peak attribute but ensures that no relevant
information is lost.</p>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_number</span></code> is used for re-scaling of the default model
parameters to the mass of interest. It is calculated upon data import by
taking the median of all mass bin centers (after initial cutting of the
spectrum) and rounding to the closest integer. This accounts for spectra
potentially containing several mass units.</p>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">default_fit_range</span></code> is scaled to the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_number</span></code>
using the relation:
<span class="math notranslate nohighlight">\(\text{default_fit_range} = 0.01\,u \cdot (\text{mass_number}/100)\)</span></p>
<dl class="py method">
<dt id="emgfit.spectrum.spectrum.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m_start</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m_stop</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">skiprows</span><span class="o">=</span><span class="default_value">18</span></em>, <em class="sig-param"><span class="n">show_plot</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">df</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#emgfit.spectrum.spectrum" title="emgfit.spectrum.spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">spectrum</span></code></a> object by importing histogrammed mass data
from .txt or .csv file.</p>
<dl class="simple">
<dt>Input file format: two-column .csv- or .txt-file with tab-separated</dt><dd><p>values (column 1: mass bin, column 2: counts in bin).
This is the default format of MAc export files when
histogram mode is used.</p>
</dd>
</dl>
<p>Optionally the spectrum can be cut to a specified fit range using the
<cite>m_start</cite> and <cite>m_stop</cite> parameters. Mass data outside this range will be
discarded and excluded from further analysis.</p>
<p>If <cite>show_plot</cite> is True, a plot of the spectrum is shown including
vertical markers for the <cite>m_start</cite> and <cite>m_stop</cite> mass cut-offs
(if applicable).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Filename of mass spectrum to analyze (as exported with MAc’s
histogram mode). If the input file is not located in the working
directory the directory path has to be included in <cite>filename</cite>, too.
If no <cite>filename</cite> is given, data must be provided via <cite>df</cite> argument.
m_start : float [u], optional
Start of fit range, data at lower masses will be discarded.
m_stop : float [u], optional
Stop of fit range, data at higher masses will be discarded.</p></li>
<li><p><strong>show_plot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, shows a plot of full spectrum with vertical markers for
<cite>m_start</cite> and <cite>m_stop</cite> cut-offs.</p></li>
<li><p><strong>df</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>, optional) – DataFrame with spectrum data to use, this enables the creation of a
spectrum object from a DataFrame instead of from an external file.
<strong>Primarily intended for internal use.</strong></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The option to import data via the <cite>df</cite> argument was added to enable the
processing of bootstrapped spectra as regular <a class="reference internal" href="#emgfit.spectrum.spectrum" title="emgfit.spectrum.spectrum"><code class="xref py py-class docutils literal notranslate"><span class="pre">spectrum</span></code></a> objects
in the <a class="reference internal" href="#emgfit.spectrum.spectrum.determine_A_stat_emg" title="emgfit.spectrum.spectrum.determine_A_stat_emg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_A_stat_emg()</span></code></a> method. This feature is primarily
intended for internal use.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum._add_peak_markers">
<code class="sig-name descname">_add_peak_markers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">yscale</span><span class="o">=</span><span class="default_value">'log'</span></em>, <em class="sig-param"><span class="n">ymax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">peaks</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum._add_peak_markers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum._add_peak_markers" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal function for adding peak markers to current figure object.</p>
<p>Place this function inside spectrum methods as <code class="docutils literal notranslate"><span class="pre">self._add_peak_markers(...)</span></code>
between <code class="docutils literal notranslate"><span class="pre">plt.figure()</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code>. Only for use on already
fitted spectra!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>yscale</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Scale of y-axis, either ‘lin’ or ‘log’.</p></li>
<li><p><strong>ymax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Maximal y-value of spectrum data to plot. Used to set marker length.</p></li>
<li><p><strong>peaks</strong> (list of <a class="reference internal" href="#emgfit.spectrum.peak" title="emgfit.spectrum.peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">peak</span></code></a>) – List of peaks to add peak markers for.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum._eval_MC_peakshape_errors">
<code class="sig-name descname">_eval_MC_peakshape_errors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_indeces</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">fit_result</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_hists</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">N_samples</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">n_cores</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">872</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">MCMC_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum._eval_MC_peakshape_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum._eval_MC_peakshape_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get peak-shape uncertainties for a fit result by re-fitting with many
different MC-shape-parameter sets</p>
<p><strong>This method is primarily intended for internal usage.</strong></p>
<p>A representative subset of the shape parameter sets which are supported
by the data is obtained by performing MCMC sampling on the peak-shape
calibrant. If this has not already been done using the <cite>map_par_covar</cite>
option in <a class="reference internal" href="#emgfit.spectrum.spectrum.determine_peak_shape" title="emgfit.spectrum.spectrum.determine_peak_shape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_peak_shape()</span></code></a>, the <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a>
method will be automatically called here.</p>
<p>The peaks specified by <cite>peak_indeces</cite> will be fitted with <cite>N_samples</cite>
different shape parameter sets. The peak-shape uncertainties are then
estimated as the RMS deviation of the obtained values from the best-fit
values.</p>
<p>The mass calibrant must either be included in <cite>peak_indeces</cite> or must
have been processed with this method upfront (using the same <cite>N_samples</cite>
and <cite>seed</cite> arguments to ensure identical sets of peak-shapes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_indeces</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>list of int</em>) – Indeces of peaks to evaluate MC peak-shape uncertainties for. The
peaks of interest must belong to the same <cite>fit_result</cite>.</p></li>
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelResult</span></code></a>, optional) – Fit result for which MC peak-shape uncertainties are to be evaluated
for. Defaults to the fit result stored for the peaks of interest in
the <code class="xref py py-attr docutils literal notranslate"><span class="pre">spectrum.fit_results</span></code> spectrum attribute.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print status updates.</p></li>
<li><p><strong>show_hists</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <cite>True</cite> histograms of the effective mass shifts and peak areas
obtained with the MC shape parameter sets are shown. Black vertical
lines indicate the best-fit values stored in <cite>fit_result</cite>.</p></li>
<li><p><strong>N_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of different shape parameter sets to use. Defaults to 1000.</p></li>
<li><p><strong>n_cores</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of CPU cores to use for parallelized fitting of simulated
spectra. When set to <cite>-1</cite> (default) all available cores are used.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Random seed to use for reproducibility. Defaults to 872.</p></li>
<li><p><strong>**MCMC_kwargs</strong> – Keyword arguments to send to <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a> for
control over the MCMC sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Peak-shape mass errors [u], peak-shape area errors [counts]
Both arrays have the same length as <cite>peak_indeces</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of floats, array of floats</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.get_MC_peakshape_errors" title="emgfit.spectrum.spectrum.get_MC_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_MC_peakshape_errors()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>For details on MCMC sampling see docs of <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a>.</p>
<p>This method only supports peaks that belong to the same fit result. If
peaks in multiple <cite>fit_results</cite> are to be treated or the peak properties
are to be updated with the refined peak-shape errors use
<a class="reference internal" href="#emgfit.spectrum.spectrum.get_MC_peakshape_errors" title="emgfit.spectrum.spectrum.get_MC_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_MC_peakshape_errors()</span></code></a> which wraps around this method.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum._eval_peakshape_errors">
<code class="sig-name descname">_eval_peakshape_errors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_indeces</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">fit_result</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_shape_err_fits</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum._eval_peakshape_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum._eval_peakshape_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the relative peak-shape uncertainty of the specified peaks.</p>
<p><strong>This internal method is automatically called by the :meth:`fit_peaks`
and :meth:`fit_calibrant` methods and does not need to be run directly
by the user.</strong></p>
<p>The peak-shape uncertainties are obtained by re-fitting the specified
peaks with each shape parameter individually varied by plus and minus 1
sigma and recording the respective shift of the peak centroids w.r.t the
original fit. From the shifted IOI centroids and the corresponding
shifts of the calibrant centroid effective mass shifts are determined.
For each varied parameter, the larger of the two eff. mass shifts are
then added in quadrature to obtain the total peak-shape uncertainty.
See <cite>Notes</cite> section below for a detailed explanation of the peak-shape
error evaluation scheme.</p>
<p>Note: All peaks in the specified <cite>peak_indeces</cite> list must
have been fitted in the same multi-peak fit (and hence have the same
lmfit modelresult <cite>fit_result</cite>)!</p>
<p>This routine does not yield a peak-shape error for the mass calibrant,
since this is zero by definition. Instead, for the mass calibrant the
absolute shifts of the peak centroid are calculated and stored in the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">eff_mass_shifts_pm</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">eff_mass_shifts</span></code> dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_indeces</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List containing indeces of peaks to evaluate peak-shape uncertainty
for, e.g. to evaluate peak-shape error of peaks 0 and 3 use
<code class="docutils literal notranslate"><span class="pre">peak_indeces=[0,3]</span></code>.</p></li>
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>, optional) – Fit result object to evaluate peak-shape error for.</p></li>
<li><p><strong>verbose</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, print all individual eff. mass shifts obtained by
varying the shape parameters.</p></li>
<li><p><strong>show_shape_err_fits</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, show individual plots of re-fits for peak-shape error
determination.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.get_MC_peakshape_errors" title="emgfit.spectrum.spectrum.get_MC_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_MC_peakshape_errors()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p><cite>sigma</cite>,`theta`, all <cite>eta</cite> and all <cite>tau</cite> model parameters are considered
“shape parameters” and varied by plus and minus one standard deviation
in the peak-shape uncertainty evaluation. The peak amplitude, centroids
and the baseline are always freely varying.</p>
<p>The “peak-shape uncertainty” refers to the mass uncertainty due to
uncertainties in the determination of the peak-shape parameters and due
to deviations between the shape-calibrant and IOI peak shapes.
Simply put, the peak-shape uncertainties are estimated by evaluating how
much a given peak centroid is shifted when the shape parameters are
varied by plus or minus their 1-sigma uncertainty. A peculiarity of
emgfit’s peak-shape error estimation routine is that only the centroid
shifts <strong>relative to the calibrant</strong> are taken into account (hence
‘<strong>effective</strong> mass shifts’).</p>
<p>Inspired by the approach outlined in <a class="footnote-reference brackets" href="#id19" id="id18">8</a>, the peak-shape uncertainties
are obtained via the following procedure:</p>
<ul class="simple">
<li><p>Since only effective mass shifts corrected for the corresponding
shifts of the calibrant peak enter the peak-shape uncertainty,
at first, the absolute centroid shifts of the mass calibrant must be
evaluated. There are two options for this:</p>
<ul>
<li><p>If the calibrant index is included in the <cite>peak_indeces</cite> argument,
the original calibrant fit is re-performed with each shape parameter
varied by plus and minus its 1-sigma confidence respectively while
all other shape parameters are kept fixed at the original best-fit
values. The resulting absolute “calibrant centroid shifts” are
recorded and stored in the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">eff_mass_shifts_pm</span></code>
dictionary. The shifted calibrant centroids are further used to
calculate updated mass re-calibration factors. These are stored in
the <code class="xref py py-attr docutils literal notranslate"><span class="pre">recal_facs_pm</span></code> dictionary. Only the larger of the two
centroid shifts due to the +/-1-sigma variation of each shape
parameter are stored in the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">eff_mass_shifts</span></code>
dictionary.</p></li>
<li><p>If the calibrant is not included in the <cite>peak_indeces</cite> list, the
calibrant centroid shifts and the corresponding shifted
recalibration factors must already have been obtained in a foregoing
mass <a class="reference internal" href="concepts.html#recalibration"><span class="std std-ref">Mass recalibration and calculation of final mass values</span></a>.</p></li>
</ul>
</li>
<li><p>All non-calibrant peaks referenced in <cite>peak_indeces</cite> are treated in a
similar way. The original fit that yielded the specified <cite>fit_result</cite>
is re-performed with each shape parameter varied by plus and minus its
1-sigma confidence respectively while all other shape parameters are
kept fixed at the original best-fit values. However now, the effective
mass shifts <strong>after correction with the corresponding updated
recalibration factor</strong> are recorded and stored in the spectrum’s
<code class="xref py py-attr docutils literal notranslate"><span class="pre">eff_mass_shifts_pm</span></code> dictionary. Only the larger of the two
eff. mass shifts caused by the +/-1-sigma variation of each shape
parameter are stored in the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">eff_mass_shifts</span></code>
dictionary.</p></li>
<li><p>The estimates for the total peak-shape uncertainty of each peak are
finally obtained by adding the eff. mass shifts stored in the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">eff_mass_shifts</span></code> dictionary in quadrature.</p></li>
</ul>
<p>Mind that peak-shape area uncertainties are only calculated for ions-of-
interest, not for the mass calibrant.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id19"><span class="brackets"><a class="fn-backref" href="#id18">8</a></span></dt>
<dd><p>San Andrés, Samuel Ayet, et al. “High-resolution, accurate
multiple-reflection time-of-flight mass spectrometry for short-lived,
exotic nuclei of a few events in their ground and low-lying isomeric
states.” Physical Review C 99.6 (2019): 064313.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum._get_MCMC_par_samples">
<code class="sig-name descname">_get_MCMC_par_samples</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fit_result</span></em>, <em class="sig-param"><span class="n">steps</span><span class="o">=</span><span class="default_value">12000</span></em>, <em class="sig-param"><span class="n">burn</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">thin</span><span class="o">=</span><span class="default_value">250</span></em>, <em class="sig-param"><span class="n">show_MCMC_fit_result</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">covar_map_fname</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_cores</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">MCMC_seed</span><span class="o">=</span><span class="default_value">1364</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum._get_MCMC_par_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Map out parameter covariances and posterior distributions using
Markov-chain Monte Carlo (MCMC) sampling</p>
<p><strong>This method is intended for internal usage and for single peaks
only.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>) – Fit result of region explore with MCMC sampling. since <cite>emcee</cite> only
efficiently samples unimodal distributions, <cite>fit_result</cite> should hold
the result of a single-peak fit (typically of the peak-shape
calibrant). The MCMC walkers are initialized with randomized
parameter values drawn from normal distributions whose mean and
standard deviation are given by the respective best-fit values and
uncertainties stored in <cite>fit_result</cite>.</p></li>
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of MCMC sampling steps.</p></li>
<li><p><strong>burn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of initial sampling steps to discard (“burn-in” phase).</p></li>
<li><p><strong>thin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – After sampling, only every <cite>thin</cite>-th sample is used for further
treatment. It is recommended to set <cite>thin</cite>  to at least half the
autocorrelation time.</p></li>
<li><p><strong>show_MCMC_fit_result</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default: False</em>) – If <cite>True</cite>, a maximum likelihood estimate is derived from the MCMC
samples with best-fit values estimated by the median of the samples.
The MCMC MLE result can be compared to the conventional <cite>fit_result</cite>
as an additional crosscheck.</p></li>
<li><p><strong>covar_map_fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em> (</em><em>default</em><em>)</em><em>, </em><em>optional</em>) – If not <cite>None</cite>, the parameter covariance map will be saved as
“&lt;covar_map_fname&gt;_covar_map.png”.</p></li>
<li><p><strong>n_cores</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em><em>, </em><em>default: -1</em>) – Number of CPU cores to use for parallelized sampling. If <cite>-1</cite>
(default) all available cores will be used.</p></li>
<li><p><strong>MCMC_seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Random state for reproducible sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p>MCMC results saved in <cite>result_emcee</cite> attribute of fit_result.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Markov-Chain Monte Carlo (MCMC) algorithms are a powerful tool to
efficiently sample the posterior probability density functions (PDFs) of
model parameters. In simpler words: MCMC methods can be used to estimate
the distributions of parameter values which are supported by the data.
An MCMC algorithm sends out a number of so-called walkers on stochastic
walks through the parameter space (in this method the number of MCMC
walkers is fixed to 20 times the number of varied parameters). MCMC
methods are particularly important in situations where conventional
sampling techniques become intractable or inefficient. For MCMC sampling
emgfit deploys lmfit’s implementation of the
<a class="reference external" href="https://emcee.readthedocs.io/en/stable/user/sampler/#emcee.EnsembleSampler" title="(in emcee v3.0.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">emcee.EnsembleSampler</span></code></a> from the <a class="reference external" href="https://iopscience.iop.org/article/10.1086/670067">emcee</a> package <a class="footnote-reference brackets" href="#id23" id="id20">1</a>. Since
emcee’s <a class="reference external" href="https://emcee.readthedocs.io/en/stable/user/sampler/#emcee.EnsembleSampler" title="(in emcee v3.0.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnsembleSampler</span></code></a> is only optimized for uni-modal
probability density functions this method should only be used to explore
the parameter space of a single-peak fit.</p>
<p>A complication with MCMC methods is that there is usually no rigorous
way to prove that the sampling chain has converged to the true PDF.
Instead it is at the user’s disgression to decide after how many
sampling steps a sufficient amount of convergence is achieved. Gladly,
there is a number of heuristic tools that can help in judging
convergence. The most common measure of the degree of convergence is the
integrated autocorrelation time (<cite>tau</cite>). If the integrated
autocorrelation time shows only small changes over time the MCMC chain
can be assumed to be converged. To ensure a sufficient degree of
convergence this method will issue a warning whenever the number of
performed sampling steps is smaller than 50 times the integrated
autocorrelation time of at least one parameter. If this rule of thumb is
violated it is strongly advisable to run a longer chain. An additonal
aid in judging the performance of the MCMC chain are the provided plots
of the MCMC traces. These plots show the paths of all MCMC walkers
through parameter space. Dramatic changes of the initial trace envelopes
indicate that the chain has not reached a stationary state yet and is
still in the so-called “burn-in” phase. Samples in this region are
discarded by setting the <cite>burn</cite> argument to an appropriate number of
steps (default burn-in: 500 steps).</p>
<p>Another complication of MCMC algorithms is the fact that nearby samples
in a MCMC chain are not indepedent. To reduce correlations between
samples MCMC chains are usually “thinned out” by only storing the result
of every m-th MCMC iteration. The number of steps after which two
samples can be assumed to be uncorrelated/independent (so to say the
memory of the chain) is given by the integrated autocorrelation time
(tau). To be conservative, emgfit uses a thinning interval of <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">250</span></code>
by default and issues a warning when <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">&lt;</span> <span class="pre">tau</span></code> for at least one of the
parameters. Since more data is discarded, a larger thinning interval
comes with a loss of precision of the posterior PDF estimates. However,
a sufficient amount of thinning is still advisable since emgfit’s MC
peak-shape error determination (<a class="reference internal" href="#emgfit.spectrum.spectrum.get_MC_peakshape_errors" title="emgfit.spectrum.spectrum.get_MC_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_MC_peakshape_errors()</span></code></a>) relies
on independent parameter samples.</p>
<p>As a helpful measure for tuning MCMC chains, emgfit provides a plot of
the “acceptance fraction” for each walker, i.e. the fraction of
suggested walker steps which were accepted. The developers of emcee’s
EnsembleSampler suggest acceptance fractions between 0.2 and 0.5 as a
rule of thumb for a well-behaved chain. Acceptance fractions falling
short of this for many walkers can indicate poor initialization or a too
small number of walkers.</p>
<p>For more details on MCMC see the excellent introductory papers
<a class="reference external" href="https://iopscience.iop.org/article/10.1086/670067">“emcee: The MCMC hammer”</a> <a class="footnote-reference brackets" href="#id23" id="id21">1</a> and
<a class="reference external" href="https://iopscience.iop.org/article/10.3847/1538-4365/aab76e">“Data Analysis Recipes: Using Markov Chain Monte Carlo”</a> <a class="footnote-reference brackets" href="#id24" id="id22">2</a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.determine_peak_shape" title="emgfit.spectrum.spectrum.determine_peak_shape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_peak_shape()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum.get_MC_peakshape_errors" title="emgfit.spectrum.spectrum.get_MC_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_MC_peakshape_errors()</span></code></a></p>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id23"><span class="brackets">1</span><span class="fn-backref">(<a href="#id20">1</a>,<a href="#id21">2</a>)</span></dt>
<dd><p>Foreman-Mackey, Daniel, et al. “emcee: the MCMC hammer.”
Publications of the Astronomical Society of the Pacific 125.925
(2013): 306.</p>
</dd>
<dt class="label" id="id24"><span class="brackets"><a class="fn-backref" href="#id22">2</a></span></dt>
<dd><p>Hogg, David W., and Daniel Foreman-Mackey. “Data analysis
recipes: Using markov chain monte carlo.” The Astrophysical Journal
Supplement Series 236.1 (2018): 11.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum._plot_df">
<em class="property">static </em><code class="sig-name descname">_plot_df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">yscale</span><span class="o">=</span><span class="default_value">'log'</span></em>, <em class="sig-param"><span class="n">peaks</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmarkers</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">thres</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ymin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ylabel</span><span class="o">=</span><span class="default_value">'Counts per bin'</span></em>, <em class="sig-param"><span class="n">xmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xmax</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum._plot_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum._plot_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots spectrum data stored in <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> <cite>df</cite>.</p>
<p><strong>Intended for internal use.</strong></p>
<p>Optionally with peak markers if:
1. single or multiple x_pos are passed to <cite>vmarkers</cite>, OR
2. list of peak objects is passed to <cite>peaks</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>) – Spectrum data to plot.</p></li>
<li><p><strong>fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.pyplot.figure</span></code>, optional) – Figure object to plot onto.</p></li>
<li><p><strong>yscale</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Scale of y-axis (<code class="docutils literal notranslate"><span class="pre">'lin'</span></code> for logarithmic, <code class="docutils literal notranslate"><span class="pre">'log'</span></code> for
logarithmic), defaults to <code class="docutils literal notranslate"><span class="pre">'log'</span></code>.</p></li>
<li><p><strong>peaks</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">peaks</span></code>, optional) – List of <code class="xref py py-class docutils literal notranslate"><span class="pre">peaks</span></code> to show peak markers for.</p></li>
<li><p><strong>vmarkers</strong> (<em>list of float</em><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – List with mass positions [u] to add vertical markers at.</p></li>
<li><p><strong>thres</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – y-level to add horizontal marker at (e.g. for indicating set
threshold in peak detection).</p></li>
<li><p><strong>ymin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Lower bound of y-range to plot.</p></li>
<li><p><strong>ylabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Custom label for y-axis.</p></li>
<li><p><strong>xmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Lower/upper bound of mass range to plot.</p></li>
<li><p><strong>xmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Lower/upper bound of mass range to plot.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.plot" title="emgfit.spectrum.spectrum.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum.plot_fit" title="emgfit.spectrum.spectrum.plot_fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_fit()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum.plot_fit_zoom" title="emgfit.spectrum.spectrum.plot_fit_zoom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_fit_zoom()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum._show_blinded_report">
<code class="sig-name descname">_show_blinded_report</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">result</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum._show_blinded_report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum._show_blinded_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Display fit result with positions of blinded peaks replaced by NaN</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum._smooth">
<em class="property">static </em><code class="sig-name descname">_smooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">11</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'hanning'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum._smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum._smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth the data for the peak detection.</p>
<p>** Intended for internal use only.**</p>
<p>This method is based on the convolution of a normalized window with the
signal. The signal is prepared by introducing reflected copies of the
signal (with the window size) in both ends so that transient parts are
minimized in the begining and end part of the output signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.array</em>) – The input data</p></li>
<li><p><strong>window_len</strong> (<em>odd int</em><em>, </em><em>optional</em>) – Length of the smoothing window; <strong>must be an odd integer</strong>!</p></li>
<li><p><strong>window</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’,
‘blackman’, flat window will produce a moving average smoothing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The smoothed spectrum data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>length(output) != length(input), to correct this:
return y[(window_len/2-1):-(window_len/2)] instead of just y.</p>
<p>Method adapted from:
<a class="reference external" href="https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html">https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html</a></p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">=</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">=</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">*</span><span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">=</span><span class="n">smooth</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum._update_calibrant_props">
<code class="sig-name descname">_update_calibrant_props</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index_mass_calib</span></em>, <em class="sig-param"><span class="n">fit_result</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum._update_calibrant_props"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum._update_calibrant_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine recalibration factor and update mass calibrant peak
properties.</p>
<p><strong>Intended for internal use only.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index_mass_calib</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of mass calibrant peak.</p></li>
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>) – Fit result to use for calculating the re-calibration factor and
for updating the calibrant properties.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum._update_peak_props">
<code class="sig-name descname">_update_peak_props</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peaks</span></em>, <em class="sig-param"><span class="n">fit_result</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum._update_peak_props"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum._update_peak_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the peak properties using the given ‘fit_result’.</p>
<p><strong>Intended for internal use only.</strong></p>
<p>The values of the mass calibrant will not be changed by
this routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of indeces of peaks to update. (To get peak indeces, see plot
markers or consult the peak properties table by calling the
<a class="reference internal" href="#emgfit.spectrum.spectrum.show_peak_properties" title="emgfit.spectrum.spectrum.show_peak_properties"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.show_peak_properties()</span></code></a> method)</p></li>
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>) – <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelResult</span></code></a> holding the fit results of all
<cite>peaks</cite> to be updated.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All peaks referenced by the ‘peaks’ argument must belong to the same
<cite>fit_result</cite>. Not necessarily all peaks contained in <cite>fit_result</cite> will
be updated, only the properties of peaks referenced with the <cite>peaks</cite>
argument will be updated.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.add_peak">
<code class="sig-name descname">add_peak</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x_pos</span></em>, <em class="sig-param"><span class="n">species</span><span class="o">=</span><span class="default_value">'?'</span></em>, <em class="sig-param"><span class="n">m_AME</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m_AME_error</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.add_peak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.add_peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually add a peak to the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list.</p>
<p>The position of the peak must be specified with the <cite>x_pos</cite> argument.
If the peak’s ionic species is provided with the <cite>species</cite> argument
the corresponding AME literature values will be added to the <a class="reference internal" href="#emgfit.spectrum.peak" title="emgfit.spectrum.peak"><code class="xref py py-attr docutils literal notranslate"><span class="pre">peak</span></code></a>.
Alternatively, user-defined literature values can be provided with the
<cite>m_AME</cite> and <cite>m_AME_error</cite> arguments. This option is helpful for isomers
or in case of very recent measurements that haven’t entered the AME yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em>) – Position of peak to be added.</p></li>
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – <code class="xref py py-attr docutils literal notranslate"><span class="pre">species</span></code> label for peak to be added following the
<a class="reference internal" href="concepts.html#notation"><span class="std std-ref">:-notation of chemical substances</span></a>. If assigned, <code class="xref py py-attr docutils literal notranslate"><span class="pre">peak.m_AME</span></code>,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">peak.m_AME_error</span></code> &amp; <code class="xref py py-attr docutils literal notranslate"><span class="pre">peak.extrapolated</span></code> are
automatically updated with the corresponding AME literature values.</p></li>
<li><p><strong>m_AME</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – User-defined literature mass for peak to be added. Overwrites pre-
existing <code class="xref py py-attr docutils literal notranslate"><span class="pre">peak.m_AME</span></code> value.</p></li>
<li><p><strong>m_AME_error</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – User-defined literature mass uncertainty for peak to be added.
Overwrites pre-existing <code class="xref py py-attr docutils literal notranslate"><span class="pre">peak.m_AME_error</span></code>.</p></li>
<li><p><strong>verbose</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a message is printed after successful peak addition.
Intended for internal use only.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.detect_peaks" title="emgfit.spectrum.spectrum.detect_peaks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">detect_peaks()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum.remove_peak" title="emgfit.spectrum.spectrum.remove_peak"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove_peak()</span></code></a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adding a peak will shift the peak_indeces of all peaks at higher masses
by <code class="docutils literal notranslate"><span class="pre">+1</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.add_peak_comment">
<code class="sig-name descname">add_peak_comment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">comment</span></em>, <em class="sig-param"><span class="n">peak_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">species</span><span class="o">=</span><span class="default_value">'?'</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.add_peak_comment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.add_peak_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a comment to a peak.</p>
<p>By default the <cite>comment</cite> argument will be appended to the end of the
current <code class="xref py py-attr docutils literal notranslate"><span class="pre">peak.comment</span></code> attribute (if the current comment is ‘-‘ it
is overwritten by the <cite>comment</cite> argument). If <cite>overwrite</cite> is set <code class="docutils literal notranslate"><span class="pre">True</span></code>,
the current <code class="xref py py-attr docutils literal notranslate"><span class="pre">peak.comment</span></code> is overwritten with the ‘comment’ argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comment</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Comment to add to peak.</p></li>
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Index of <a class="reference internal" href="#emgfit.spectrum.peak" title="emgfit.spectrum.peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">peak</span></code></a> to add comment to.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt><code class="xref py py-attr docutils literal notranslate"><span class="pre">x_pos</span></code> of peak to add comment to (must be specified up to 6th</dt><dd><p>decimal).</p>
</dd>
</dl>
</p></li>
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – <code class="xref py py-attr docutils literal notranslate"><span class="pre">species</span></code> of peak to add comment to.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> the current peak <code class="xref py py-attr docutils literal notranslate"><span class="pre">comment</span></code> will be overwritten
by <cite>comment</cite>, else <cite>comment</cite> is appended to the end of the current
peak <code class="xref py py-attr docutils literal notranslate"><span class="pre">comment</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The shape and mass calibrant peaks are automatically marked during the
shape and mass calibration by inserting the protected flags <code class="docutils literal notranslate"><span class="pre">'shape</span> <span class="pre">calibrant'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'mass</span> <span class="pre">calibrant'</span></code> or <code class="docutils literal notranslate"><span class="pre">'shape</span> <span class="pre">and</span> <span class="pre">mass</span> <span class="pre">calibrant'</span></code> into their peak
comments. When user-defined comments are added to these peaks, it is
ensured that the protected flags cannot be overwritten. <strong>The above
shape and mass calibrant flags should never be added to comments
manually by the user!</strong></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.add_spectrum_comment">
<code class="sig-name descname">add_spectrum_comment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">comment</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.add_spectrum_comment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.add_spectrum_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a general comment to the spectrum.</p>
<p>By default the <cite>comment</cite> argument will be appended to the end of the current
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spectrum_comment</span></code> attribute. If <cite>overwrite</cite> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
the current <code class="xref py py-attr docutils literal notranslate"><span class="pre">spectrum_comment</span></code> is overwritten with <cite>comment</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comment</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Comment to add to spectrum.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the current <code class="xref py py-attr docutils literal notranslate"><span class="pre">spectrum_comment</span></code> attribute will be
overwritten with <cite>comment</cite>, else <cite>comment</cite> is appended to the end of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spectrum_comment</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.add_peak_comment" title="emgfit.spectrum.spectrum.add_peak_comment"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_peak_comment()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">spectrum_comment</span></code> will be included in the output file storing all fit
results and can hence be useful to pass on information for the
post-processing.</p>
<p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">spectrum_comment</span></code> is ‘-‘ (default value) it is always
overwritten with <cite>comment</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.assign_species">
<code class="sig-name descname">assign_species</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">species</span></em>, <em class="sig-param"><span class="n">peak_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_pos</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.assign_species"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.assign_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign species label(s) to a single peak (or all peaks at once).</p>
<p>If no single peak is selected with <cite>peak_index</cite> or <cite>x_pos</cite>, a list with
species names for <strong>all</strong> peaks in the peak list must be passed to
<cite>species</cite>. For already specified or unkown species insert <code class="docutils literal notranslate"><span class="pre">None</span></code> as a
placeholder to skip the species assignment for this peak. See <cite>Notes</cite>
and <cite>Examples</cite> sections below for details on usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>list of str</em>) – The species name (or list of name strings) to be assigned to the
selected peak (or to all peaks). For unkown or already assigned
species, <code class="docutils literal notranslate"><span class="pre">None</span></code> should be inserted as placeholder at the
corresponding position in the <cite>species</cite> list. <code class="xref py py-attr docutils literal notranslate"><span class="pre">species</span></code> names
must follow the <a class="reference internal" href="concepts.html#notation"><span class="std std-ref">:-notation of chemical substances</span></a>.</p></li>
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Index of single peak to assign <cite>species</cite> name to.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – <code class="xref py py-attr docutils literal notranslate"><span class="pre">x_pos</span></code> of single peak to assign <cite>species</cite> name to. Must be
specified up to 6th decimal.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Assignment of a single peak species:
select peak by specifying peak position <cite>x_pos</cite> (up to 6th decimal) or
<cite>peak_index</cite> argument (0-based! Check for peak index by calling
<a class="reference internal" href="#emgfit.spectrum.spectrum.show_peak_properties" title="emgfit.spectrum.spectrum.show_peak_properties"><code class="xref py py-meth docutils literal notranslate"><span class="pre">show_peak_properties()</span></code></a> method on spectrum object).</p></li>
<li><p>Assignment of multiple peak species:
Nothing should be passed to the ‘peak_index’ and ‘x_pos’ arguments.
Instead the user specifies a list of the new species strings to the
<cite>species</cite> argument (if there’s N detected peaks, the list must have
length N). Former species assignments can be kept by inserting blanks
at the respective position in the <cite>species</cite> list, otherwise former
species assignments are overwritten, also see examples below for
usage.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Assign the peak with peak_index 2 (third-lowest-mass peak) as
‘1Cs133:-1e’, leave all other peaks unchanged:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">emgfit</span> <span class="k">as</span> <span class="nn">emg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">emg</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="o">&lt;</span><span class="n">input_file</span><span class="o">&gt;</span><span class="p">)</span> <span class="c1"># mock code for foregoing data import</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">detect_peaks</span><span class="p">()</span> <span class="c1"># mock code for foregoing peak detection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">assign_species</span><span class="p">(</span><span class="s1">&#39;1Cs133:-1e&#39;</span><span class="p">,</span><span class="n">peak_index</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Assign multiple peaks:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">emgfit</span> <span class="k">as</span> <span class="nn">emg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">emg</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="o">&lt;</span><span class="n">input_file</span><span class="o">&gt;</span><span class="p">)</span> <span class="c1"># mock code for foregoing data import</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">detect_peaks</span><span class="p">()</span> <span class="c1"># mock code for foregoing peak detection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">assign_species</span><span class="p">([</span><span class="s1">&#39;1Ru102:-1e&#39;</span><span class="p">,</span> <span class="s1">&#39;1Pd102:-1e&#39;</span><span class="p">,</span> <span class="s1">&#39;Rh102:-1e?&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span><span class="s1">&#39;1Sr83:1F19:-1e&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>This assigns the species of the first, second, third and fourth peak
with the respective labels in the specified list and fetches their AME
values. The <cite>‘?’</cite> in the <code class="docutils literal notranslate"><span class="pre">'Rh102:-1e?'</span></code> argument indicates a tentative
species assignment, literature values will not be calculated for this
peak. The <code class="docutils literal notranslate"><span class="pre">None</span></code> argument leaves the species assignment of the 4th
peak unchanged. The <code class="docutils literal notranslate"><span class="pre">'?'</span></code> argument overwrites any former species
assignments to the highest-mass peak and marks the peak as unidentified.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.bootstrap_spectrum">
<em class="property">static </em><code class="sig-name descname">bootstrap_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">N_events</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_cen</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_range</span><span class="o">=</span><span class="default_value">0.02</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.bootstrap_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.bootstrap_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Create simulated spectrum via bootstrap re-sampling from spectrum <cite>df</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (class:<cite>pandas.DataFrame</cite>) – Original histogrammed spectrum data to re-sample from.</p></li>
<li><p><strong>N_events</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of events to create via bootstrap re-sampling, defaults to
number of events in original DataFrame <cite>df</cite>.</p></li>
<li><p><strong>x_cen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Center of mass range to re-sample from. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, re-sample from
full mass range of input data <cite>df</cite>.</p></li>
<li><p><strong>x_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Width of mass range to re-sample from. Defaults to 0.02 u. <cite>x_range</cite>
is only relevant if a <cite>x_cen</cite> argument is specified.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Histogram with simulated spectrum data from non-parametric
bootstrap.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.1.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.calc_FWHM_emg">
<code class="sig-name descname">calc_FWHM_emg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">fit_result</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.calc_FWHM_emg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.calc_FWHM_emg" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the full width at half maximum (FWHM) of a Hyper-EMG fit.</p>
<p>The peak of interest must have previously been fitted with a Hyper-EMG
model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak of interest.</p></li>
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>, optional) – Fit result containing peak of interest. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default) the
corresponding fit result from the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit_results</span></code>
list will be fetched.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Full width at half maximum of Hyper-EMG fit of peak of interest.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.calc_peak_area">
<code class="sig-name descname">calc_peak_area</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">fit_result</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">decimals</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.calc_peak_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.calc_peak_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the peak area (counts in peak) and its stat. uncertainty.</p>
<p>Area and area error are calculated using the peak’s amplitude parameter
<cite>amp</cite> and the width of the uniform binning of the spectrum. Therefore,
the peak must have been fitted beforehand. In the case of overlapping
peaks only the counts within the fit component of the specified peak are
returned.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This routine assumes the bin width to be uniform across the spectrum.
The mass binning of most mass spectra is not perfectly uniform
(usually time bins are uniform such that the width of mass bins has a
quadratic scaling with mass). However, for isobaric species the
quadratic term is usually so small that it can safely be neglected.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Index of peak of interest.</p></li>
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>, optional) – Fit result object to use for area calculation. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)
use corresponding fit result stored in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit_results</span></code> list.</p></li>
<li><p><strong>decimals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of decimals of returned output values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List with peak area and area error in format [area, area_error].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.calc_sigma_emg">
<code class="sig-name descname">calc_sigma_emg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span></em>, <em class="sig-param"><span class="n">fit_result</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.calc_sigma_emg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.calc_sigma_emg" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the standard deviation of a Hyper-EMG peak fit.</p>
<p>The peak of interest must have previously been fitted with a Hyper-EMG
model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Index of peak of interest.</p></li>
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>, optional) – Fit result containing peak of interest. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default) the
corresponding fit result from the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit_results</span></code>
list will be fetched.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Standard deviation of Hyper-EMG fit of peak of interest.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.comp_model">
<code class="sig-name descname">comp_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peaks_to_fit</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">'emg22'</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vary_shape</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">vary_baseline</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">index_first_peak</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.comp_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.comp_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a multi-peak composite model with the specified peak shape.</p>
<p><strong>Primarily intended for internal usage.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks_to_fit</strong> (list of <a class="reference internal" href="#emgfit.spectrum.peak" title="emgfit.spectrum.peak"><code class="xref py py-class docutils literal notranslate"><span class="pre">peak</span></code></a>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">peaks</span></code> to be fitted with composite model.</p></li>
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Name of fit model to use for all peaks (e.g. <code class="docutils literal notranslate"><span class="pre">'Gaussian'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'emg12'</span></code>, <code class="docutils literal notranslate"><span class="pre">'emg33'</span></code>, … - for full list see
<a class="reference internal" href="concepts.html#fit-model-list"><span class="std std-ref">Available fit models</span></a>).</p></li>
<li><p><strong>init_pars</strong> (dict, optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Default initial shape parameters for fit model. If <code class="docutils literal notranslate"><span class="pre">None</span></code> the
default parameters defined in the <a class="reference internal" href="#module-emgfit.fit_models" title="emgfit.fit_models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">fit_models</span></code></a> module
will be used after scaling to the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_number</span></code>.
For more details and a list of all shape parameters see the
<a class="reference internal" href="concepts.html#peak-shape-calibration"><span class="std std-ref">Peak-shape calibration</span></a> article.</p></li>
<li><p><strong>vary_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code> only the amplitude (<cite>amp</cite>) and Gaussian centroid (<cite>mu</cite>)
model parameters will be varied in the fit. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the shape
parameters (<cite>sigma</cite>, <cite>theta</cite>,`etas` and <cite>taus</cite>) will also be varied.</p></li>
<li><p><strong>vary_baseline</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> a varying uniform baseline will be added to the fit
model as varying model parameter <cite>c_bkg</cite>. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the baseline
parameter <cite>c_bkg</cite> will be kept fixed at 0.</p></li>
<li><p><strong>index_first_peak</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Index of first (lowest mass) peak in fit range, used for enforcing
common shape for all peaks.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The initial amplitude for each peak is estimated by taking the counts in
the bin closest to the peak’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">x_pos</span></code> and scaling this number with
an empirically determined constant and the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_number</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.detect_peaks">
<code class="sig-name descname">detect_peaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">thres</span><span class="o">=</span><span class="default_value">0.003</span></em>, <em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">23</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'blackman'</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">2e-05</span></em>, <em class="sig-param"><span class="n">plot_smoothed_spec</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_2nd_deriv</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_detection_result</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.detect_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.detect_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform automatic peak detection.</p>
<p>The peak detection routine uses a scaled second derivative of the
spectrum <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code> after first applying some smoothing. This enables
very sensitive yet robust peak detection. The parameters <cite>thres</cite>,
<cite>window_len</cite> &amp; <cite>width</cite> can be used to tune the smoothing and peak
detection for maximal sensitivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thres</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Threshold for peak detection in the inverted and scaled second
derivative of the smoothed spectrum.</p></li>
<li><p><strong>window_len</strong> (<em>odd int</em><em>, </em><em>optional</em>) – Length of window used for smoothing the spectrum (in no. of bins).
<strong>Must be an ODD integer.</strong></p></li>
<li><p><strong>window</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The window function used for smooting the spectrum. Defaults to
<code class="docutils literal notranslate"><span class="pre">'blackman'</span></code>. Other options: <code class="docutils literal notranslate"><span class="pre">'flat'</span></code>, <code class="docutils literal notranslate"><span class="pre">'hanning'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'hamming'</span></code>, <code class="docutils literal notranslate"><span class="pre">'bartlett'</span></code>. See also <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/routines.window.html">NumPy window functions</a>.</p></li>
<li><p><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Minimal FWHM of peaks to be detected. Caution: To achieve maximal
sensitivity for overlapping peaks this number might have to be set
to less than the peak’s FWHM! In challenging cases use the plot of
the scaled inverted second derivative (by setting <cite>plot_2nd_deriv</cite>
to <code class="docutils literal notranslate"><span class="pre">True</span></code>) to ensure that the detection threshold is set properly.</p></li>
<li><p><strong>plot_smoothed_spec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> a plot with the original and the smoothed spectrum is
shown.</p></li>
<li><p><strong>plot_2nd_deriv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> a plot with the scaled, inverted second derivative of
the smoothed spectrum is shown.</p></li>
<li><p><strong>plot_detection_result</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> a plot of the spectrum with markers for the detected
peaks is shown.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.add_peak" title="emgfit.spectrum.spectrum.add_peak"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_peak()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum.remove_peak" title="emgfit.spectrum.spectrum.remove_peak"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove_peak()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>For details on the smoothing, see docs of <a class="reference internal" href="#emgfit.spectrum.spectrum._smooth" title="emgfit.spectrum.spectrum._smooth"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_smooth()</span></code></a> by calling:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="n">emgfit</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">_smooth</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.determine_A_stat_emg">
<code class="sig-name descname">determine_A_stat_emg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">species</span><span class="o">=</span><span class="default_value">'?'</span></em>, <em class="sig-param"><span class="n">x_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_range</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">N_spectra</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">fit_model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cost_func</span><span class="o">=</span><span class="default_value">'MLE'</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'least_squares'</span></em>, <em class="sig-param"><span class="n">fit_kws</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vary_baseline</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.determine_A_stat_emg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.determine_A_stat_emg" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the constant of proprotionality <cite>A_stat_emg</cite> for
calculation of the statistical uncertainties of Hyper-EMG fits.</p>
<p>This method updates the <code class="xref py py-attr docutils literal notranslate"><span class="pre">A_stat_emg</span></code> &amp; <code class="xref py py-attr docutils literal notranslate"><span class="pre">A_stat_emg_error</span></code>
spectrum attributes. The former will be used for all subsequent stat.
error estimations.</p>
<p><strong>This routine must be called AFTER a successful peak-shape calibration
and should be called BEFORE the mass re-calibration.</strong></p>
<p><cite>A_stat_emg</cite> is determined by evaluating the statistical fluctuations of
a representative peak’s centroid as a function of the number of ions in
the reference peak. The fluctuations are estimated by fitting
a large number of synthetic spectra derived from the experimental
data via bootstrap re-sampling. For details see <cite>Notes</cite> section below.</p>
<p>Specify the peak to use for the bootstrap re-sampling by providing
<strong>either</strong> of the <cite>peak_index</cite>, <cite>species</cite> and <cite>x_pos</cite> arguments. The
peak should be well-separated and have decent statistics (typically the
peak-shape calibrant is used).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Index of representative peak to use for bootstrap re-sampling
(typically, the peak-shape calibrant). The peak should have high
statistics and must be well-separated from other peaks.</p></li>
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – String with species name of representative peak to use for bootstrap
re-sampling (typically, the peak-shape calibrant). The peak should
have high statistics and be well-separated from other peaks.</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Marker position (<code class="xref py py-attr docutils literal notranslate"><span class="pre">x_pos</span></code> spectrum attribute) of representative
peak to use for bootstrap re-sampling (typically, the peak-shape
calibrant). The peak should have high statistics and be well-
separated from other peaks. <cite>x_pos</cite> must be specified up to the 6th
decimal.</p></li>
<li><p><strong>x_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Mass range around peak centroid over which events will be sampled
and fitted. <strong>Choose such that no secondary peaks are contained in
the mass range!</strong> If <code class="docutils literal notranslate"><span class="pre">None</span></code> defaults to <code class="xref py py-attr docutils literal notranslate"><span class="pre">default_fit_range</span></code>
spectrum attribute.</p></li>
<li><p><strong>N_spectra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em><em>, </em><em>default: 1000</em>) – Number of bootstrapped spectra to create at each number of ions.</p></li>
<li><p><strong>cost_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: 'MLE'</em>) – <p>Name of cost function to use for minimization.</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'chi-square'</span></code>, the fit is performed by minimizing Pearson’s
chi-squared statistic:</p>
<div class="math notranslate nohighlight">
\[\chi^2_P = \sum_i \frac{(f(x_i) - y_i)^2}{f(x_i)}.\]</div>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'MLE'</span></code>, a binned maximum likelihood estimation is performed
by minimizing the (doubled) negative log-likelihood ratio:</p>
<div class="math notranslate nohighlight">
\[L = 2\sum_i \left[ f(x_i) - y_i + y_i ln\left(\frac{y_i}{f(x_i)}\right)\right]\]</div>
</li>
</ul>
<p>For details see <cite>Notes</cite> section of <a class="reference internal" href="#emgfit.spectrum.spectrum.peakfit" title="emgfit.spectrum.spectrum.peakfit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">peakfit()</span></code></a> method documentation.</p>
</p></li>
<li><p><strong>method</strong> (str, optional, default: <cite>‘least_squares’</cite>) – Name of minimization algorithm to use. For full list of options
check arguments of <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.minimize" title="(in lmfit v1.0.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">lmfit.minimizer.minimize()</span></code></a>.</p></li>
<li><p><strong>fit_kws</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – Options to pass to lmfit minimizer used in
<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model.fit" title="(in lmfit v1.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lmfit.model.Model.fit()</span></code></a> method.</p></li>
<li><p><strong>vary_baseline</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the constant background will be fitted with a varying
uniform baseline parameter <cite>bkg_c</cite> (initial value: 0.1).
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the baseline parameter <cite>bkg_c</cite> will be fixed to 0.</p></li>
<li><p><strong>plot_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the plots will be saved to two separate files named
‘&lt;<cite>plot_filename</cite>&gt;_log_plot.png’ and ‘&lt;<cite>plot_filename</cite>&gt;_lin_plot.png’.
<strong>Caution: Existing files with identical name are overwritten.</strong></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>As noted in <a class="footnote-reference brackets" href="#id26" id="id25">9</a>, statistical errors of Hyper-EMG peak centroids obey
the following scaling with the number of counts in the peak <cite>N_counts</cite>:</p>
<div class="math notranslate nohighlight">
\[\sigma_{stat} = A_{stat,emg} \frac{FWHM}{\sqrt{N_{counts}}},\]</div>
<p>where the constant of proportionality <cite>A_stat_emg</cite> depends on the
specific peak shape. This routine uses the following method to determine
<cite>A_stat_emg</cite>:</p>
<ul class="simple">
<li><p><cite>N_spectra</cite> bootstrapped spectra are created for each of the following
total numbers of events: [10,30,100,300,1000,3000,10000,30000].</p></li>
<li><p>Each bootstrapped spectrum is fitted and the best fit peak centroids
are recorded.</p></li>
<li><p>The statistical uncertainties are estimated by taking the sample
standard deviations of the recorded peak centroids at each value of
<cite>N_counts</cite>. Since the best-fit peak area can deviate from the true
number of re-sampled events in the spectrum, the mean best_fit area at
each number of re-sampled events is used to determine <cite>N_counts</cite>.</p></li>
<li><p><cite>A_stat_emg</cite> is finally determined by plotting the rel. statistical
uncertainty as function of <cite>N_counts</cite> and fitting it with the above
equation.</p></li>
</ul>
<p>The resulting value for <cite>A_stat_emg</cite> will be stored as spectrum
attribute and will be used in all subsequent fits to calculate the stat.
errors from the number of counts in the peak.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id26"><span class="brackets"><a class="fn-backref" href="#id25">9</a></span></dt>
<dd><p>San Andrés, Samuel Ayet, et al. “High-resolution, accurate
multiple-reflection time-of-flight mass spectrometry for short-lived,
exotic nuclei of a few events in their ground and low-lying isomeric
states.” Physical Review C 99.6 (2019): 064313.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.determine_peak_shape">
<code class="sig-name descname">determine_peak_shape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index_shape_calib</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">species_shape_calib</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fit_model</span><span class="o">=</span><span class="default_value">'emg22'</span></em>, <em class="sig-param"><span class="n">cost_func</span><span class="o">=</span><span class="default_value">'chi-square'</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">x_fit_cen</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_fit_range</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vary_baseline</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'least_squares'</span></em>, <em class="sig-param"><span class="n">fit_kws</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vary_tail_order</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_fit_reports</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_plots</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_peak_markers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sigmas_of_conf_band</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">plot_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">map_par_covar</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">MCMC_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.determine_peak_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.determine_peak_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine optimal peak-shape parameters by fitting the specified
peak-shape calibrant.</p>
<p>If <cite>vary_tail_order</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) an automatic model selection
is performed before the calibration of the peak-shape parameters.</p>
<p>It is recommended to visually check whether the fit residuals
are purely stochastic (as should be the case for a decent model). If
this is not the case either the selected model does not describe the
data well, the initial parameters lead to poor convergence or there are
additional undetected peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index_shape_calib</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Index of shape-calibration peak. Preferrable alternative: Specify
the shape-calibrant with the <cite>species_shape_calib</cite> argument.</p></li>
<li><p><strong>species_shape_calib</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Species name of the shape-calibrant peak in <a class="reference internal" href="concepts.html#notation"><span class="std std-ref">:-notation of chemical substances</span></a> (e.g.
<code class="docutils literal notranslate"><span class="pre">'K39:-1e'</span></code>). Alternatively, the peak to use can be specified with
the <cite>index_shape_calib</cite> argument.</p></li>
<li><p><strong>fit_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: 'emg22'</em>) – Name of fit model to use for shape calibration (e.g. <code class="docutils literal notranslate"><span class="pre">'Gaussian'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'emg12'</span></code>, <code class="docutils literal notranslate"><span class="pre">'emg33'</span></code>, … - for full list see
<a class="reference internal" href="concepts.html#fit-model-list"><span class="std std-ref">Available fit models</span></a>). If the automatic model selection
(<cite>vary_tail_order=True</cite>) fails or is turned off, <cite>fit_model</cite> will be
used for the shape calibration and set as the spectrum’s
<code class="xref py py-attr docutils literal notranslate"><span class="pre">fit_model</span></code> attribute.</p></li>
<li><p><strong>cost_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: 'chi-square'</em>) – <p>Name of cost function to use for minimization. <strong>It is strongly
recommended to use ‘chi-square’-fitting for the peak-shape
determination</strong> since this yields more robust results for fits with
many model parameters as well as more trustworthy parameter
uncertainties (important for peak-shape error determinations).</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'chi-square'</span></code>, the fit is performed by minimizing Pearson’s
chi-squared statistic:</p>
<div class="math notranslate nohighlight">
\[\chi^2_P = \sum_i \frac{(f(x_i) - y_i)^2}{f(x_i)}.\]</div>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'MLE'</span></code>, a binned maximum likelihood estimation is performed
by minimizing the (doubled) negative log likelihood ratio:</p>
<div class="math notranslate nohighlight">
\[L = 2\sum_i \left[ f(x_i) - y_i + y_i ln\left(\frac{y_i}{f(x_i)}\right)\right]\]</div>
</li>
</ul>
<p>For details see <cite>Notes</cite> section of <a class="reference internal" href="#emgfit.spectrum.spectrum.peakfit" title="emgfit.spectrum.spectrum.peakfit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">peakfit()</span></code></a> method documentation.</p>
</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Dictionary with initial shape parameter values for fit (optional).</p>
<blockquote>
<div><ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">'default'</span></code> (default), the default parameters
defined for mass 100 in the <a class="reference internal" href="#module-emgfit.fit_models" title="emgfit.fit_models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">emgfit.fit_models</span></code></a> module will
be used after re-scaling to the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_number</span></code>.</p></li>
<li><p>To define custom initial values, a parameter dictionary containing
all model parameters and their values in the format
<code class="docutils literal notranslate"><span class="pre">{'&lt;param</span> <span class="pre">name&gt;':&lt;param_value&gt;,...}</span></code> should be passed to
<cite>init_pars</cite>.</p></li>
</ul>
</div></blockquote>
<p>Mind that only the initial values to shape parameters
(<cite>sigma</cite>, <cite>theta</cite>,`etas` and <cite>taus</cite>) can be user-defined. The
<cite>mu</cite> parameter will be initialized at the peak’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">x_cen</span></code>
attribute and the initial peak amplitude <cite>amp</cite> is automatically
estimated from the counts at the bin closest to <cite>x_cen</cite>. If a
varying baseline is used in the fit, the baseline parameter
<cite>bgd_c</cite> is always initialized at a value of 0.1.</p>
</p></li>
<li><p><strong>x_fit_cen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Center of fit range. If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default), the <code class="xref py py-attr docutils literal notranslate"><span class="pre">x_pos</span></code>
attribute of the shape-calibrant peak is used as <cite>x_fit_cen</cite>.</p></li>
<li><p><strong>x_fit_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Mass range to fit. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">default_fit_range</span></code> spectrum attribute.</p></li>
<li><p><strong>vary_baseline</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the background will be fitted with a varying uniform
baseline parameter <cite>bkg_c</cite> (initial value: 0.1). If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the
baseline parameter <cite>bkg_c</cite> will be fixed to 0.</p></li>
<li><p><strong>method</strong> (str, optional, default: <cite>‘least_squares’</cite>) – Name of minimization algorithm to use. For full list of options
check arguments of <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.minimize" title="(in lmfit v1.0.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">lmfit.minimizer.minimize()</span></code></a>.</p></li>
<li><p><strong>fit_kws</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – Options to pass to lmfit minimizer used in
<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model.fit" title="(in lmfit v1.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lmfit.model.Model.fit()</span></code></a> method.</p></li>
<li><p><strong>vary_tail_order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), before the calibration of the peak-shape
parameters an automatized fit model selection is performed. For
details on the automatic model selection, see <cite>Notes</cite> section below.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the specified <cite>fit_model</cite> argument is used as model
for the peak-shape determination.</p></li>
<li><p><strong>show_fit_reports</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default: True</em>) – Whether to print fit reports for the fits in the automatic model
selection.</p></li>
<li><p><strong>show_plots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), linear and logarithmic plots of the spectrum
and the best fit curve are displayed. For details see
<a class="reference internal" href="#emgfit.spectrum.spectrum.plot_fit" title="emgfit.spectrum.spectrum.plot_fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.plot_fit()</span></code></a>.</p></li>
<li><p><strong>show_peak_markers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), peak markers are added to the plots.</p></li>
<li><p><strong>sigmas_of_conf_band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em><em>, </em><em>default: 0</em>) – Confidence level of confidence band around best fit curve in sigma.</p></li>
<li><p><strong>plot_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the plots of the shape-calibration will be saved to
two separate files named ‘&lt;<cite>plot_filename</cite>&gt;_log_plot.png’ and
‘&lt;<cite>plot_filename</cite>&gt;_lin_plot.png’. <strong>Caution: Existing files with
identical name are overwritten.</strong></p></li>
<li><p><strong>map_par_covar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> the parameter covariances will be mapped using
Markov-Chain Monte Carlo (MCMC) sampling and shown in a corner plot.
This feature is only recommended for single-peak fits.</p></li>
<li><p><strong>**MCMC_kwargs</strong> (<em>optional</em>) – Options to send to <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a>. Only relevant when
<cite>map_par_covar</cite> is True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Ideally the peak-shape calibration is performed on a well-separated peak
with high statistics. If this is not possible, the peak-shape
calibration can also be attempted using overlapping peaks since emgfit
ensures shared and identical shape parameters for all peaks in a multi-
peak fit.</p>
<p>Automatic model selection:
When the model selection is activated the routine tries to find the peak
shape that minimizes the fit’s chi-squared reduced by successively
adding more tails on the right and left. Finally, that fit model is
selected which yields the lowest chi-squared reduced without having any
of the tail weight parameters <cite>eta</cite> compatible with zero within 1-sigma
uncertainty. The latter models are excluded as is this an indication of
overfitting. Models for which the calculation of any <cite>eta</cite> parameter
uncertainty fails are likewise excluded from selection.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.fit_calibrant">
<code class="sig-name descname">fit_calibrant</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index_mass_calib</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">species_mass_calib</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fit_model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cost_func</span><span class="o">=</span><span class="default_value">'MLE'</span></em>, <em class="sig-param"><span class="n">x_fit_cen</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_fit_range</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vary_baseline</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'least_squares'</span></em>, <em class="sig-param"><span class="n">fit_kws</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show_plots</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_peak_markers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sigmas_of_conf_band</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">show_fit_report</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.fit_calibrant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.fit_calibrant" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine mass re-calibration factor by fitting the selected
calibrant peak.</p>
<p>After the mass calibrant has been fitted the recalibration factor and
its uncertainty are calculated and saved as the spectrum’s
<code class="xref py py-attr docutils literal notranslate"><span class="pre">recal_fac</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">recal_fac_error</span></code> attributes.</p>
<p>The calibrant peak can either be specified with the <cite>index_mass_calib</cite>
or the <cite>species_mass_calib</cite> argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index_mass_calib</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Index of mass calibrant peak.</p></li>
<li><p><strong>species_mass_calib</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Species of peak to use as mass calibrant.</p></li>
<li><p><strong>fit_model</strong> (str, optional, default: <code class="docutils literal notranslate"><span class="pre">'emg22'</span></code>) – Name of fit model to use (e.g. <code class="docutils literal notranslate"><span class="pre">'Gaussian'</span></code>, <code class="docutils literal notranslate"><span class="pre">'emg12'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'emg33'</span></code>, … - for full list see <a class="reference internal" href="concepts.html#fit-model-list"><span class="std std-ref">Available fit models</span></a>).</p></li>
<li><p><strong>cost_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: 'chi-square'</em>) – <p>Name of cost function to use for minimization.</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'chi-square'</span></code>, the fit is performed by minimizing Pearson’s
chi-squared statistic:</p>
<div class="math notranslate nohighlight">
\[\chi^2_P = \sum_i \frac{(f(x_i) - y_i)^2}{f(x_i)}.\]</div>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'MLE'</span></code>, a binned maximum likelihood estimation is performed
by minimizing the (doubled) negative log likelihood ratio:</p>
<div class="math notranslate nohighlight">
\[L = 2\sum_i \left[ f(x_i) - y_i + y_i ln\left(\frac{y_i}{f(x_i)}\right)\right]\]</div>
</li>
</ul>
<p>See <cite>Notes</cite> of <a class="reference internal" href="#emgfit.spectrum.spectrum.peakfit" title="emgfit.spectrum.spectrum.peakfit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.peakfit()</span></code></a> for more details.</p>
</p></li>
<li><p><strong>x_fit_cen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>[</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – center of mass range to fit;
if None, defaults to marker position (x_pos) of mass calibrant peak</p></li>
<li><p><strong>x_fit_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – width of mass range to fit; if None, defaults to ‘default_fit_range’ spectrum attribute</p></li>
<li><p><strong>vary_baseline</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the constant background will be fitted with a varying
uniform baseline parameter <cite>bkg_c</cite> (initial value: 0.1).
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the baseline parameter <cite>bkg_c</cite> will be fixed to 0.</p></li>
<li><p><strong>method</strong> (str, optional, default: <cite>‘least_squares’</cite>) – Name of minimization algorithm to use. For full list of options
check arguments of <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.minimize" title="(in lmfit v1.0.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">lmfit.minimizer.minimize()</span></code></a>.</p></li>
<li><p><strong>fit_kws</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – Options to pass to lmfit minimizer used in
<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model.fit" title="(in lmfit v1.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lmfit.model.Model.fit()</span></code></a> method.</p></li>
<li><p><strong>show_plots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) linear and logarithmic plots of the spectrum
with the best fit curve are displayed. For details see
<a class="reference internal" href="#emgfit.spectrum.spectrum.plot_fit" title="emgfit.spectrum.spectrum.plot_fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.plot_fit()</span></code></a>.</p></li>
<li><p><strong>show_peak_markers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) peak markers are added to the plots.</p></li>
<li><p><strong>sigmas_of_conf_band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em><em>, </em><em>default: 0</em>) – Confidence level of confidence band around best fit curve in sigma.
Note that the confidence band is only derived from the uncertainties
of the parameters that are varied during the fit.</p></li>
<li><p><strong>show_fit_report</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) the fit results are reported.</p></li>
<li><p><strong>plot_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the plots will be saved to two separate files named
‘&lt;<cite>plot_filename</cite>&gt;_log_plot.png’ and ‘&lt;<cite>plot_filename</cite>&gt;_lin_plot.png’.
<strong>Caution: Existing files with identical name are overwritten.</strong></p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.fit_peaks" title="emgfit.spectrum.spectrum.fit_peaks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.fit_peaks()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>The <a class="reference internal" href="#emgfit.spectrum.spectrum.fit_peaks" title="emgfit.spectrum.spectrum.fit_peaks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.fit_peaks()</span></code></a> method enables the simultaneous fitting
of mass calibrant and ions of interest in a single multi-peak fit and
can be used as an alternative to this method.</p>
<p>After the calibrant fit the <a class="reference internal" href="#emgfit.spectrum.spectrum._eval_peakshape_errors" title="emgfit.spectrum.spectrum._eval_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum._eval_peakshape_errors()</span></code></a>
method is automatically called to save the absolute calibrant centroid
shifts as preparation for subsequent peak-shape error determinations.</p>
<p>Since the spectrum has already been coarsely calibrated via the time-
resolved calibration in the MR-TOF-MS’s data acquisition software MAc,
the recalibration (or precision calibration) factor is usually very
close to unity. An error will be raised by the
<a class="reference internal" href="#emgfit.spectrum.spectrum._update_calibrant_props" title="emgfit.spectrum.spectrum._update_calibrant_props"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum._update_calibrant_props()</span></code></a> method if
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spectrum.recal_fac</span></code> deviates from unity by more than a permille
since this causes some implicit approximations for the calculation of
the final mass values and their uncertainties to break down.</p>
<p>The statistical uncertainty of the peak is calculated via the following
relation <a class="footnote-reference brackets" href="#id28" id="id27">10</a>:</p>
<p>For Gaussians the constant of proportionality <span class="math notranslate nohighlight">\(A_{stat}\)</span> is always
given by <span class="math notranslate nohighlight">\(A_{stat,G}\)</span> = 0.425. For Hyper-EMG models
<span class="math notranslate nohighlight">\(A_{stat}=A_{stat,emg}\)</span> is either set to the default value
<cite>A_stat_emg_default</cite> defined in the <a class="reference internal" href="#module-emgfit.config" title="emgfit.config"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config</span></code></a> module or
determined by running the <a class="reference internal" href="#emgfit.spectrum.spectrum.determine_A_stat_emg" title="emgfit.spectrum.spectrum.determine_A_stat_emg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.determine_A_stat_emg()</span></code></a> method.
The latter is usually preferable since this accounts for the specifics
of the given peak shape.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id28"><span class="brackets"><a class="fn-backref" href="#id27">10</a></span></dt>
<dd><p>San Andrés, Samuel Ayet, et al. “High-resolution, accurate
multiple-reflection time-of-flight mass spectrometry for short-lived,
exotic nuclei of a few events in their ground and low-lying isomeric
states.” Physical Review C 99.6 (2019): 064313.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.fit_peaks">
<code class="sig-name descname">fit_peaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_indeces</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">index_mass_calib</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">species_mass_calib</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_fit_cen</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_fit_range</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fit_model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cost_func</span><span class="o">=</span><span class="default_value">'MLE'</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'least_squares'</span></em>, <em class="sig-param"><span class="n">fit_kws</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vary_shape</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">vary_baseline</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_plots</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_peak_markers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sigmas_of_conf_band</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">plot_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show_fit_report</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_shape_err_fits</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.fit_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.fit_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit peaks, update peaks properties and show results.</p>
<p>By default, the full mass range and all peaks in the spectrum are
fitted. Optionally, only peaks specified with <cite>peak_indeces</cite> or peaks in
the mass range specified with <cite>x_fit_cen</cite> and <cite>x_fit_range</cite> are fitted.</p>
<p>Optionally, the mass recalibration can be performed simultaneously with
the IOI fit if the mass calibrant is in the fit range and specified with
either the <cite>index_mass_calib</cite> or <cite>species_mass_calib</cite> arguments.
Otherwise a mass recalibration must have been performed upfront.</p>
<p>Before running this method a successful peak-shape calibration must have
been performed with <a class="reference internal" href="#emgfit.spectrum.spectrum.determine_peak_shape" title="emgfit.spectrum.spectrum.determine_peak_shape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_peak_shape()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_indeces</strong> (<em>list of int</em><em>, </em><em>optional</em>) – List of neighbouring peaks to fit. The fit range will be chosen such
that at least a mass range of <cite>x_fit_range</cite>/2 is included around
each peak.</p></li>
<li><p><strong>x_fit_cen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Center of mass range to fit (only specify if a subset of the
spectrum is to be fitted)</p></li>
<li><p><strong>x_fit_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Width of mass range to fit. If <code class="docutils literal notranslate"><span class="pre">None</span></code> defaults to:
<code class="xref py py-attr docutils literal notranslate"><span class="pre">spectrum.default_fit_range</span></code> attribute, only specify if subset
of spectrum is to be fitted. This argument is only relevant if
<cite>x_fit_cen</cite> is also specified.</p></li>
<li><p><strong>fit_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Name of fit model to use (e.g. <code class="docutils literal notranslate"><span class="pre">'Gaussian'</span></code>, <code class="docutils literal notranslate"><span class="pre">'emg12'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'emg33'</span></code>, … - for full list see <a class="reference internal" href="concepts.html#fit-model-list"><span class="std std-ref">Available fit models</span></a>). If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit_model</span></code> spectrum
attribute.</p></li>
<li><p><strong>cost_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: 'chi-square'</em>) – <p>Name of cost function to use for minimization.</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'chi-square'</span></code>, the fit is performed by minimizing Pearson’s
chi-squared statistic:</p>
<div class="math notranslate nohighlight">
\[\chi^2_P = \sum_i \frac{(f(x_i) - y_i)^2}{f(x_i)^2}.\]</div>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'MLE'</span></code>, a binned maximum likelihood estimation is performed
by minimizing the (doubled) negative log likelihood ratio:</p>
<div class="math notranslate nohighlight">
\[L = 2\sum_i \left[ f(x_i) - y_i + y_i ln\left(\frac{y_i}{f(x_i)}\right)\right]\]</div>
</li>
</ul>
<p>See <cite>Notes</cite> of <a class="reference internal" href="#emgfit.spectrum.spectrum.peakfit" title="emgfit.spectrum.spectrum.peakfit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">peakfit()</span></code></a> method for details.</p>
</p></li>
<li><p><strong>method</strong> (str, optional, default: <cite>‘least_squares’</cite>) – Name of minimization algorithm to use. For full list of options
check arguments of <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.minimize" title="(in lmfit v1.0.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">lmfit.minimizer.minimize()</span></code></a>.</p></li>
<li><p><strong>fit_kws</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – Options to pass to lmfit minimizer used in
<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model.fit" title="(in lmfit v1.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lmfit.model.Model.fit()</span></code></a> method.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Dictionary with initial shape parameter values for fit (optional).</p>
<blockquote>
<div><ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default) the parameters from the shape calibration
(<code class="xref py py-attr docutils literal notranslate"><span class="pre">peak_shape_pars</span></code> spectrum attribute) are used.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'default'</span></code>, the default parameters defined for mass 100 in
the <a class="reference internal" href="#module-emgfit.fit_models" title="emgfit.fit_models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">emgfit.fit_models</span></code></a> module will be used after re-scaling
to the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_number</span></code>.</p></li>
<li><p>To define custom initial values a parameter dictionary containing
all model parameters and their values in the format
<code class="docutils literal notranslate"><span class="pre">{'&lt;param</span> <span class="pre">name&gt;':&lt;param_value&gt;,...}</span></code> should be passed to
<cite>init_pars</cite>.</p></li>
</ul>
</div></blockquote>
<p>Mind that only the initial values to shape parameters
(<cite>sigma</cite>, <cite>theta</cite>,`etas` and <cite>taus</cite>) can be user-defined. The
<cite>mu</cite> parameter will be initialized at the peak’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">x_cen</span></code>
attribute and the initial peak amplitude <cite>amp</cite> is automatically
estimated from the counts at the bin closest to <cite>x_cen</cite>. If a
varying baseline is used in the fit, the baseline parameter
<cite>bgd_c</cite> is always initialized at a value of 0.1.</p>
</p></li>
<li><p><strong>vary_shape</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code> peak-shape parameters (<cite>sigma</cite>, <cite>theta</cite>,`etas` and
<cite>taus</cite>) are kept fixed at their initial values. If <code class="docutils literal notranslate"><span class="pre">True</span></code> the
shared shape parameters are varied (ensuring identical shape
parameters for all peaks).</p></li>
<li><p><strong>vary_baseline</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the constant background will be fitted with a varying
uniform baseline parameter <cite>bkg_c</cite> (initial value: 0.1).
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the baseline parameter <cite>bkg_c</cite> will be fixed to 0.</p></li>
<li><p><strong>show_plots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) linear and logarithmic plots of the spectrum
with the best fit curve are displayed. For details see
<a class="reference internal" href="#emgfit.spectrum.spectrum.plot_fit" title="emgfit.spectrum.spectrum.plot_fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.plot_fit()</span></code></a>.</p></li>
<li><p><strong>show_peak_markers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) peak markers are added to the plots.</p></li>
<li><p><strong>sigmas_of_conf_band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em><em>, </em><em>default: 0</em>) – Confidence level of confidence band around best-fit curve in sigma.
Note that the confidence band is only derived from the uncertainties
of the parameters that are varied during the fit.</p></li>
<li><p><strong>plot_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the plots will be saved to two separate files named
‘&lt;<cite>plot_filename</cite>&gt;_log_plot.png’ and ‘&lt;<cite>plot_filename</cite>&gt;_lin_plot.png’.
<strong>Caution: Existing files with identical name are overwritten.</strong></p></li>
<li><p><strong>show_fit_report</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) the detailed lmfit fit report is printed.</p></li>
<li><p><strong>show_shape_err_fits</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default: True</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, plots of all fits performed for the peak-shape
uncertainty evaluation are shown.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Updates peak properties dataframe with peak properties obtained in fit.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.get_MC_peakshape_errors">
<code class="sig-name descname">get_MC_peakshape_errors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_indeces</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_hists</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_peak_properties</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">rerun_MCMC_sampling</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">N_samples</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">n_cores</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">872</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">MCMC_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.get_MC_peakshape_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.get_MC_peakshape_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get peak-shape uncertainties by re-fitting peaks with many different
MC-shape-parameter sets</p>
<p>This method provides refined peak-shape uncertainties that account for
non-normal distributions and correlations of shape parameters. To that
end, the peaks of interest are re-fitted with <cite>N_samples</cite> different
peak-shape parameter sets. For these parameter sets to be representative
of all peak shapes supported by the data they are randomly drawn from a
larger ensemble of parameter sets obtained from Markov-Chain Monte Carlo
(MCMC) sampling on the peak-shape calibrant. The peak-shape uncertainty
of the mass values and peak areas are estimated by the obtained RMS
deviations from the best-fit values. Finally, the peak properties table
is updated with the refined uncertainties.</p>
<p>This method only takes effective mass shifts relative to the calibrant
peak into account. For each peak shape the calibrant peak is re-fitted
and the respective recalibration factors are used to calculate shifted
ion-of-interest masses. Therefore, the mass calibrant must be included
in <cite>peak_indeces</cite>.</p>
<p><strong>When the `peak_indeces` argument is used, it must include the mass
calibrant.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_indeces</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>list of int</em><em>, </em><em>optional</em>) – Indeces of peaks to evaluate MC peak-shape uncertainties for.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print status updates and intermediate results.</p></li>
<li><p><strong>show_hists</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <cite>True</cite> histograms of the effective mass shifts and peak areas
obtained with the MC shape parameter sets are shown. Black vertical
lines indicate the best-fit values obtained with <a class="reference internal" href="#emgfit.spectrum.spectrum.fit_peaks" title="emgfit.spectrum.spectrum.fit_peaks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_peaks()</span></code></a>.</p></li>
<li><p><strong>show_peak_properties</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <cite>True</cite> the peak properties table including the updated peak-shape
uncertainties is shown.</p></li>
<li><p><strong>rerun_MCMC_sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – When <cite>False</cite> (default) pre-existing MCMC parameter samples (e.g.
obtained with <a class="reference internal" href="#emgfit.spectrum.spectrum.determine_peak_shape" title="emgfit.spectrum.spectrum.determine_peak_shape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_peak_shape()</span></code></a>) are used. If <cite>True</cite> or
when there’s no pre-existing MCMC samples, the MCMC sampling will be
performed by this method.</p></li>
<li><p><strong>N_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of different shape parameter sets to use. Defaults to 1000.</p></li>
<li><p><strong>n_cores</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of CPU cores to use for parallelized fitting of simulated
spectra. When set to <cite>-1</cite> (default) all available cores are used.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Random seed to use for reproducibility. Defaults to 872.</p></li>
<li><p><strong>**MCMC_kwargs</strong> – Keyword arguments to send to <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a> for
control over the MCMC sampling.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum._eval_MC_peakshape_errors" title="emgfit.spectrum.spectrum._eval_MC_peakshape_errors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_eval_MC_peakshape_errors()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>This method relies on a representative sample of all the shape parameter
sets which are supported by the data. These shape parameter sets are
randomly drawn from a large sample of parameter sets obtained from
Markov-Chain Monte Carlo (MCMC) sampling on the peak-shape calibrant.
In MCMC sampling so-called walkers are sent on random walks to explore
the parameter space. The latter is done with the
<a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a> method. If MCMC sampling has already
been performed with the <cite>map_par_covar</cite> option in
<a class="reference internal" href="#emgfit.spectrum.spectrum.determine_peak_shape" title="emgfit.spectrum.spectrum.determine_peak_shape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_peak_shape()</span></code></a>, these MCMC samples will be
used for the MC peak-shape error evaluation. If there is no pre-existing
MCMC parameter sets the <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a> method will be
automatically evoked before the MC peak-shape error evaluation.</p>
<p>Assuming that the samples obtained with the MCMC algorithm form a
representative set of parameter samples and are sufficiently independent
from each other, this method provides refined peak-shape uncertainties
that account for correlations and non-normal posterior distributions
of peak-shape parameters. In particular, this prevents overestimation of
the uncertainties due to non-consideration of parameter correlations.</p>
<p>For this method to be accurate a sufficiently large number of MCMC
sampling steps should be performed and fits should be performed with a
large number of parameter sets (<code class="docutils literal notranslate"><span class="pre">N_samples</span> <span class="pre">&gt;=</span> <span class="pre">1000</span></code>). For the MCMC
parameter samples to be independent a sufficient amount of thinning has
to be applied to remove autocorrelation between MCMC samples. Thinning
refers to the common practice of only storing the results of every k-th
MCMC iteration. The length and thinning of the MCMC chain is controlled
with the <cite>steps</cite> and <cite>thin</cite> MCMC keyword arguments. For more details and
references on MCMC sampling with emgfit see the docs of the underlying
<a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a> method.</p>
<p>For the peak-shape mass errors only effective mass shifts relative to
the calibrant centroid are relevant. Therefore the mass calibrant and
the ions of interest (IOI) are fitted with the same peak-shape-parameter
sets and the final mass values are calculated with the obtained IOI
centroids and the respective mass recalibration factors.</p>
<p>This method only takes effective mass shifts relative to the calibrant
peak into account. For each peak shape the calibrant peak is re-fitted
and the respective recalibration factors are used to calculate the
shifted ion-of-interest masses.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.get_errors_from_resampling">
<code class="sig-name descname">get_errors_from_resampling</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_indeces</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">N_spectra</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">n_cores</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">show_hists</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">show_peak_properties</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.get_errors_from_resampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.get_errors_from_resampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Get statistical and area uncertainties via resampling from best-fit
PDF and update peak properties therewith.</p>
<p>This method provides bootstrap estimates of the statistical errors and
peak area errors by evaluating the scatter of peak centroids and areas
in fits of many simulated spectra. The simulated spectra are created by
sampling events from the best-fit PDF asociated with <cite>fit_result</cite>
(parametric bootstrap). Refined errors are calculated for each peak
individually by taking the sample standard deviations of the obtained
peak centroids and areas.</p>
<p>If the peaks in <cite>peak_indeces</cite> have been fitted separately a parametric
bootstrap will be performed for each of the different fits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_indeces</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – List containing indeces of peaks to determine refined stat. and area
errors for, e.g. to evaluate peak-shape error of peaks 1 and 2 use
<code class="docutils literal notranslate"><span class="pre">peak_indeces=[1,2]</span></code>. Defaults to all peaks in the spectrum’s
<code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list.</p></li>
<li><p><strong>N_spectra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of simulated spectra to fit. Defaults to 1000, which
typically yields statistical uncertainty estimates with a relative
precision of a few percent.</p></li>
<li><p><strong>n_cores</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of CPU cores to use for parallelized fitting of simulated
spectra. When set to <cite>-1</cite> (default) all available cores are used.</p></li>
<li><p><strong>show_hists</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default: False</em>) – If <cite>True</cite>, histograms of the obtained peak centroids and areas are
shown. Black vertical lines indicate the best-fit values obtained
from the measured data.</p></li>
<li><p><strong>show_peak_properties</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default: True</em>) – If <cite>True</cite>, the peak properties table is shown after updating the
statistical and area errors.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.determine_A_stat_emg" title="emgfit.spectrum.spectrum.determine_A_stat_emg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">determine_A_stat_emg()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum.parametric_bootstrap" title="emgfit.spectrum.spectrum.parametric_bootstrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parametric_bootstrap()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Only the statistical mass and area uncertainties of ion-of-interest
peaks are updated. The uncertainties of the mass calibrant and the
recalibration uncertainty remain unaffected by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.load_peak_shape_cal">
<code class="sig-name descname">load_peak_shape_cal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.load_peak_shape_cal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.load_peak_shape_cal" title="Permalink to this definition">¶</a></dt>
<dd><p>Load peak shape from the TXT-file named ‘filename.txt’.</p>
<p>Successfully loaded shape calibration parameters and their uncertainties
are used as the new <code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_cal_pars</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_cal_errors</span></code> spectrum attributes respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Name of input file (‘.txt’ extension is automatically appended).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.parametric_bootstrap">
<code class="sig-name descname">parametric_bootstrap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fit_result</span></em>, <em class="sig-param"><span class="n">peak_indeces</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">N_spectra</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">n_cores</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">show_hists</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.parametric_bootstrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.parametric_bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Get statistical and area uncertainties via resampling from best-fit
PDF.</p>
<p><strong>This method is primarily for internal usage.</strong></p>
<p>This method provides bootstrap estimates of the statistical errors and
peak area errors by evaluating the scatter of peak centroids and areas
in fits of many simulated spectra. The simulated spectra are created by
sampling events from the best-fit PDF asociated with <cite>fit_result</cite>
(parametric bootstrap). Refined errors are calculated for each peak
individually by taking the sample standard deviations of the obtained
peak centroids and areas.</p>
<p><em>All peaks for which refined errors are to be evaluated must belong to
the same lmfit ModelResult `fit_result`. Even if refined stat. errors
are only to be extracted for a subset of the peaks contained in
`fit_result` (as specified with `peak_indeces`), fits will be
re-performed over the same x-range as `fit_result`.</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>) – Fit result object to evaluate statistical errors for.</p></li>
<li><p><strong>peak_indeces</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – List containing indeces of peaks to determine refined stat. errors
for, e.g. to evaluate peak-shape error of peaks 1 and 2 use
<code class="docutils literal notranslate"><span class="pre">peak_indeces=[1,2]</span></code>. Listed peaks must be included in
<cite>fit_result</cite>. Defaults to all peaks contained in <cite>fit_result</cite>.</p></li>
<li><p><strong>N_spectra</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of simulated spectra to fit. Defaults to 1000, which
typically yields statistical uncertainty estimates with a relative
precision of a few percent.</p></li>
<li><p><strong>n_cores</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – Number of CPU cores to use for parallelized fitting of simulated
spectra. When set to <cite>-1</cite> (default) all available cores are used.</p></li>
<li><p><strong>show_hists</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default: False</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, histograms of the obtained peak centroids and areas are
shown. Black vertical lines indicate the best-fit values obtained
from the measured data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array with statistical errors [u], array with area errors [u]
Array elements correspond to the results for the peaks selected in
<cite>peak_indeces</cite> (in ascending order). If <cite>peak_indeces</cite> has not been
specified it defaults to the indeces of all peaks contained in
<cite>fit_result</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.get_errors_from_resampling" title="emgfit.spectrum.spectrum.get_errors_from_resampling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_errors_from_resampling()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.peakfit">
<code class="sig-name descname">peakfit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fit_model</span><span class="o">=</span><span class="default_value">'emg22'</span></em>, <em class="sig-param"><span class="n">cost_func</span><span class="o">=</span><span class="default_value">'chi-square'</span></em>, <em class="sig-param"><span class="n">x_fit_cen</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_fit_range</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init_pars</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vary_shape</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">vary_baseline</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'least_squares'</span></em>, <em class="sig-param"><span class="n">fit_kws</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show_plots</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">show_peak_markers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sigmas_of_conf_band</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">plot_filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">map_par_covar</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">MCMC_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.peakfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.peakfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal routine for fitting peaks.</p>
<p>Fits full spectrum or subrange (if <cite>x_fit_cen</cite> and <cite>x_fit_range</cite> are
specified) and optionally shows results.</p>
<p><strong>This method is for internal usage. Use :meth:`spectrum.fit_peaks`
method to fit peaks and automatically update peak properties dataframe
with obtained fit results!</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_model</strong> (str, optional, default: <code class="docutils literal notranslate"><span class="pre">'emg22'</span></code>) – Name of fit model to use (e.g. <code class="docutils literal notranslate"><span class="pre">'Gaussian'</span></code>, <code class="docutils literal notranslate"><span class="pre">'emg12'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'emg33'</span></code>, … - for full list see <a class="reference internal" href="concepts.html#fit-model-list"><span class="std std-ref">Available fit models</span></a>).</p></li>
<li><p><strong>cost_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: 'chi-square'</em>) – <p>Name of cost function to use for minimization.</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'chi-square'</span></code>, the fit is performed by minimizing Pearson’s
chi-squared statistic:</p>
<div class="math notranslate nohighlight">
\[\chi^2_P = \sum_i \frac{(f(x_i) - y_i)^2}{f(x_i)}.\]</div>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'MLE'</span></code>, a binned maximum likelihood estimation is performed
by minimizing the (doubled) negative log-likelihood ratio:</p>
<div class="math notranslate nohighlight">
\[L = 2\sum_i \left[ f(x_i) - y_i + y_i ln\left(\frac{y_i}{f(x_i)}\right)\right]\]</div>
</li>
</ul>
<p>See <cite>Notes</cite> below for details.</p>
</p></li>
<li><p><strong>x_fit_cen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Center of mass range to fit (only specify if subset of spectrum is
to be fitted).</p></li>
<li><p><strong>x_fit_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Width of mass range to fit (only specify if subset of spectrum is to
be fitted, only relevant if <cite>x_fit_cen</cite> is likewise specified). If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to <code class="xref py py-attr docutils literal notranslate"><span class="pre">default_fit_range</span></code> spectrum attribute.</p></li>
<li><p><strong>init_pars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Dictionary with initial shape parameter values for fit (optional).</p>
<ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">None</span></code> (default) the parameters from the shape calibration
are used (if no shape calibration has been performed yet the
default parameters defined for mass 100 in the
<a class="reference internal" href="#module-emgfit.fit_models" title="emgfit.fit_models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">emgfit.fit_models</span></code></a> module will be used after re-scaling to
the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_number</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">'default'</span></code>, the default parameters defined for mass 100 in
the <a class="reference internal" href="#module-emgfit.fit_models" title="emgfit.fit_models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">emgfit.fit_models</span></code></a> module will be used after re-scaling
to the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">mass_number</span></code>.</p></li>
<li><p>To define custom initial values a parameter dictionary containing
all model parameters and their values in the format
<code class="docutils literal notranslate"><span class="pre">{'&lt;param</span> <span class="pre">name&gt;':&lt;param_value&gt;,...}</span></code> should be passed to
<cite>init_pars</cite>. Mind that only the initial values to shape parameters
(<cite>sigma</cite>, <cite>theta</cite>,`etas` and <cite>taus</cite>) can be user-defined. The
<cite>mu</cite> parameter will be initialized at the peak’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">x_cen</span></code>
attribute and the initial peak amplitude <cite>amp</cite> is automatically
estimated from the counts at the bin closest to <cite>x_cen</cite>. If a
varying baseline is used in the fit, the baseline parameter
<cite>bgd_c</cite> is always initialized at a value of 0.1.</p></li>
</ul>
</p></li>
<li><p><strong>vary_shape</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code> peak-shape parameters (<cite>sigma</cite>, <cite>theta</cite>,`etas` and
<cite>taus</cite>) are kept fixed at their initial values. If <code class="docutils literal notranslate"><span class="pre">True</span></code> the
shared shape parameters are varied (ensuring identical shape
parameters for all peaks).</p></li>
<li><p><strong>vary_baseline</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the constant background will be fitted with a varying
uniform baseline parameter <cite>bkg_c</cite> (initial value: 0.1).
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the baseline parameter <cite>bkg_c</cite> will be fixed to 0.</p></li>
<li><p><strong>method</strong> (str, optional, default: <cite>‘least_squares’</cite>) – Name of minimization algorithm to use. For full list of options
check arguments of <a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.minimize" title="(in lmfit v1.0.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">lmfit.minimizer.minimize()</span></code></a>.</p></li>
<li><p><strong>fit_kws</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – Options to pass to lmfit minimizer used in
<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model.fit" title="(in lmfit v1.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lmfit.model.Model.fit()</span></code></a> method.</p></li>
<li><p><strong>show_plots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) linear and logarithmic plots of the spectrum
with the best fit curve are displayed. For details see
<a class="reference internal" href="#emgfit.spectrum.spectrum.plot_fit" title="emgfit.spectrum.spectrum.plot_fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectrum.plot_fit()</span></code></a>.</p></li>
<li><p><strong>show_peak_markers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default) peak markers are added to the plots.</p></li>
<li><p><strong>sigmas_of_conf_band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em><em>, </em><em>default: 0</em>) – Confidence level of confidence band around best fit curve in sigma.
Note that the confidence band is only derived from the uncertainties
of the parameters that are varied during the fit.</p></li>
<li><p><strong>plot_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the plots will be saved to two separate files named
‘&lt;<cite>plot_filename</cite>&gt;_log_plot.png’ and ‘&lt;<cite>plot_filename</cite>&gt;_lin_plot.png’.
<strong>Caution: Existing files with identical name are overwritten.</strong></p></li>
<li><p><strong>map_par_covar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> the parameter covariances will be mapped using
Markov-Chain Monte Carlo (MCMC) sampling and shown in a corner plot.
This feature is only recommended for single-peak fits.</p></li>
<li><p><strong>**MCMC_kwargs</strong> (<em>optional</em>) – Options to send to <a class="reference internal" href="#emgfit.spectrum.spectrum._get_MCMC_par_samples" title="emgfit.spectrum.spectrum._get_MCMC_par_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_get_MCMC_par_samples()</span></code></a>. Only relevant when
<cite>map_par_covar</cite> is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Fit model result.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.fit_peaks" title="emgfit.spectrum.spectrum.fit_peaks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_peaks()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum.fit_calibrant" title="emgfit.spectrum.spectrum.fit_calibrant"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_calibrant()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>In fits with the <code class="docutils literal notranslate"><span class="pre">chi-square</span></code> cost function the variance weights
<span class="math notranslate nohighlight">\(w_i\)</span> for the residuals are estimated using the latest model
predictions: <span class="math notranslate nohighlight">\(w_i = 1/(\sigma_i^2 + \epsilon) = 1/(f(x_i)+ \epsilon)\)</span>,
where <span class="math notranslate nohighlight">\(\epsilon = 1e-10\)</span> is a small number added to increase
numerical robustness when <span class="math notranslate nohighlight">\(f(x_i)\)</span> approaches zero. On each
iteration the weights are updated with the new values of the model
function.</p>
<p>When performing <code class="docutils literal notranslate"><span class="pre">MLE</span></code> fits including bins with low statistics the
value for chi-squared as well as the parameter standard errors and
correlations in the lmfit fit report should be taken with caution.
This is because strictly speaking emgfit’s <code class="docutils literal notranslate"><span class="pre">MLE</span></code> cost function only
approximates a chi-squared distribution in the limit of a large number
of counts in every bin (“Wick’s theorem”). For a detailed derivation of
this statement see pp. 94-95 of these <a class="reference external" href="https://www.hep.phy.cam.ac.uk/~thomson/lectures/statistics/Fitting_Handout.pdf">lecture slides by Mark Thompson</a>.
In practice and if needed, one can simply test the validity of the
reported fit statistic as well as parameter standard errors &amp;
correlations by re-performing the same fit with <cite>cost_func=’chi-square’</cite>
and comparing the results. In all tested cases decent agreement was
found even if the fit range contained low-statistics bins. Even if a
deviation occurs this is irrelevant in most pratical cases since the
mass errors reported in emgfit’s peak properties table are independent
of the lmfit parameter standard errors given as additional information
below. Only the peak area errors are by default calculated using the
standard errors of the <cite>amp</cite> parameters reported by lmfit.</p>
<p>Besides the asymptotic concergence to a chi-squared distribution
emgfit’s <code class="docutils literal notranslate"><span class="pre">MLE</span></code> cost function has a second handy property - all
summands in the log-likelihood ratio are positive semi-definite:
<span class="math notranslate nohighlight">\(L_i = f(x_i) - y_i + y_i ln\left(\frac{y_i}{f(x_i)}\right) \geq 0\)</span>.
Exploiting this property, the minimization of the log-likelihood ratio
can be re-formulated into a least-squares problem (see also <a class="footnote-reference brackets" href="#id30" id="id29">11</a>):</p>
<div class="math notranslate nohighlight">
\[L = 2\sum_i L_i = 2\sum_i \left( \sqrt{ L_i } \right)^2.\]</div>
<p>Instead of minimizing the scalar log-likelihood ratio, emgfit by default
minimizes the sum-of-squares of the square-roots of the summands
<span class="math notranslate nohighlight">\(L_i\)</span> in the log-likelihood ratio. This is mathematically
equivalent to minimizing <span class="math notranslate nohighlight">\(L\)</span> and facilitates the
usage of Scipy’s highly efficient least-squares optimizers
(‘least_squares’ &amp; ‘leastsq’). The latter yield significant speed-ups
compared to scalar optimizers such as Scipy’s ‘Nelder-Mead’ or ‘Powell’
methods. By default, emgfit’s ‘MLE’ fits are performed with Scipy’s
‘least_squares’ optimizer, a variant of a Levenberg-Marquardt algorithm
for bound-constrained problems. If a scalar optimizaton method is
chosen emgfit uses the conventional approach of minimizing the scalar
<span class="math notranslate nohighlight">\(L\)</span>. For more details on these optimizers see the docs of
<a class="reference external" href="https://lmfit.github.io/lmfit-py/fitting.html#lmfit.minimizer.minimize" title="(in lmfit v1.0.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">lmfit.minimizer.minimize()</span></code></a> and <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.optimize</span></code>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id30"><span class="brackets"><a class="fn-backref" href="#id29">11</a></span></dt>
<dd><p>Ross, G. J. S. “Least squares optimisation of general
log-likelihood functions and estimation of separable linear
parameters.” COMPSTAT 1982 5th Symposium held at Toulouse 1982.
Physica, Heidelberg, 1982.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peaks</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">yscale</span><span class="o">=</span><span class="default_value">'log'</span></em>, <em class="sig-param"><span class="n">vmarkers</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">thres</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ymin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xmax</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot mass spectrum (without fit curve).</p>
<p>Vertical markers are added for all peaks specified with <cite>peaks</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (list of <code class="xref py py-class docutils literal notranslate"><span class="pre">peaks</span></code>, optional) – List of <code class="xref py py-class docutils literal notranslate"><span class="pre">peaks</span></code> to show peak markers for. Defaults to
<code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code>.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Optional plot title.</p></li>
<li><p><strong>fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.pyplot.figure</span></code>, optional) – Figure object to plot onto.</p></li>
<li><p><strong>yscale</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Scale of y-axis (<code class="docutils literal notranslate"><span class="pre">'lin'</span></code> for logarithmic, <code class="docutils literal notranslate"><span class="pre">'log'</span></code> for
logarithmic), defaults to <code class="docutils literal notranslate"><span class="pre">'log'</span></code>.</p></li>
<li><p><strong>vmarkers</strong> (<em>list of float</em><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – List with mass positions [u] to add vertical markers at.</p></li>
<li><p><strong>thres</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – y-level to add horizontal marker at (e.g. for indicating set
threshold in peak detection).</p></li>
<li><p><strong>ymin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Lower bound of y-range to plot.</p></li>
<li><p><strong>xmin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Lower/upper bound of mass range to plot.</p></li>
<li><p><strong>xmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Lower/upper bound of mass range to plot.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#emgfit.spectrum.spectrum.plot_fit" title="emgfit.spectrum.spectrum.plot_fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_fit()</span></code></a>, <a class="reference internal" href="#emgfit.spectrum.spectrum.plot_fit_zoom" title="emgfit.spectrum.spectrum.plot_fit_zoom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_fit_zoom()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.plot_fit">
<code class="sig-name descname">plot_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fit_result</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot_title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show_peak_markers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sigmas_of_conf_band</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">x_min</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_max</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot_filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.plot_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot data and fit result in logarithmic and linear y-scale.</p>
<p>Only a single fit result can be plotted with this method. If neither
<cite>fit_result</cite> nor <cite>x_min</cite> and <cite>x_max</cite> are specified, the full mass range
is plotted.</p>
<p>Plots can be saved to a file using the <cite>plot_filename</cite> argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fit_result</strong> (<a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a>, optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) – Fit result to plot. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to fit result of first
peak in specified mass range (taken from <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit_results</span></code> list).</p></li>
<li><p><strong>plot_title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Title of plots. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to a string with the fit model
name and cost function of the <cite>fit_result</cite> to ensure clear
indication of how the fit was obtained.</p></li>
<li><p><strong>show_peak_markers</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, peak markers are added to the plots.</p></li>
<li><p><strong>sigmas_of_conf_band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em><em>, </em><em>default: 0</em>) – Coverage probability of confidence band in sigma (only shown in
log-plot). If <code class="docutils literal notranslate"><span class="pre">0</span></code>, no confidence band is shown (default).</p></li>
<li><p><strong>x_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Start and end of mass range to plot. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to the
minimum and maximum of the spectrum’s mass <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
<li><p><strong>x_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Start and end of mass range to plot. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to the
minimum and maximum of the spectrum’s mass <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
<li><p><strong>plot_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the plots will be saved to two separate files named
‘&lt;<cite>plot_filename</cite>&gt;_log_plot.png’ &amp; ‘&lt;<cite>plot_filename</cite>&gt;_lin_plot.png’.
<strong>Caution: Existing files with identical name are overwritten.</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.plot_fit_zoom">
<code class="sig-name descname">plot_fit_zoom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_indeces</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_center</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_range</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">plot_title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show_peak_markers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sigmas_of_conf_band</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">plot_filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.plot_fit_zoom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.plot_fit_zoom" title="Permalink to this definition">¶</a></dt>
<dd><p>Show logarithmic and linear plots of data and fit curve zoomed to
peaks or mass range of interest.</p>
<p>There is two alternatives to define the plots’ mass ranges:</p>
<ol class="arabic simple">
<li><p>Specifying peaks-of-interest with the <cite>peak_indeces</cite>
argument. The mass range is then automatically chosen to include all
peaks of interest. The minimal mass range to include around each peak
of interest can be adjusted using <cite>x_range</cite>.</p></li>
<li><p>Specifying a mass range of interest with the <cite>x_center</cite> and <cite>x_range</cite>
arguments.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_indeces</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>list of ints</em><em>, </em><em>optional</em>) – Index of single peak or indeces of multiple neighboring peaks to
show (peaks must belong to the same <code class="xref py py-attr docutils literal notranslate"><span class="pre">fit_result</span></code>).</p></li>
<li><p><strong>x_center</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Center of manually specified mass range to plot.</p></li>
<li><p><strong>x_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em><em>, </em><em>default: 0.01</em>) – Width of mass range to plot around ‘x_center’ or minimal mass range
to include around each specified peak of interest.</p></li>
<li><p><strong>plot_title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em>) – Title of plots. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to a string with the fit model
name and cost function of the <cite>fit_result</cite> to ensure clear
indication of how the fit was obtained.</p></li>
<li><p><strong>show_peak_markers</strong> (bool, optional, default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, peak markers are added to the plots.</p></li>
<li><p><strong>sigmas_of_conf_band</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em><em>, </em><em>default: 0</em>) – Coverage probability of confidence band in sigma (only shown in
log-plot). If <code class="docutils literal notranslate"><span class="pre">0</span></code>, no confidence band is shown (default).</p></li>
<li><p><strong>x_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Start and end of mass range to plot. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to the
minimum and maximum of the spectrum’s mass <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code> is used.</p></li>
<li><p><strong>x_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> [</em><em>u</em><em>]</em><em>, </em><em>optional</em>) – Start and end of mass range to plot. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to the
minimum and maximum of the spectrum’s mass <code class="xref py py-attr docutils literal notranslate"><span class="pre">data</span></code> is used.</p></li>
<li><p><strong>plot_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>, </em><em>optional</em><em>, </em><em>default: None</em>) – If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the plots will be saved to two separate files named
‘&lt;<cite>plot_filename</cite>&gt;_log_plot.png’ &amp; ‘&lt;<cite>plot_filename</cite>&gt;_lin_plot.png’.
<strong>Caution: Existing files with identical name are overwritten.</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.remove_peak">
<code class="sig-name descname">remove_peak</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">species</span><span class="o">=</span><span class="default_value">'?'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.remove_peak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.remove_peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove specified peak from the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list.</p>
<p>Select the peak to be removed by specifying either the respective
<cite>peak_index</cite>, <cite>species</cite> label or peak marker position <cite>x_pos</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>list of int</em><em>, </em><em>optional</em>) – Indeces of peak(s) to remove from the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list
(0-based!).</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><em>list of float</em><em> [</em><em>u</em><em>]</em>) – <code class="xref py py-attr docutils literal notranslate"><span class="pre">x_pos</span></code> of peak(s) to remove from the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code>
list. Peak marker positions must be specified up to the 6th decimal.</p></li>
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>list of str</em>) – <code class="xref py py-attr docutils literal notranslate"><span class="pre">species</span></code> label(s) of peak(s) to remove from the spectrum’s
<code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>This method is deprecated in v0.1.1 and will likely be removed in
future versions, use :meth:`~spectrum.remove_peaks` instead!</em></p>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.remove_peaks">
<code class="sig-name descname">remove_peaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">peak_indeces</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">species</span><span class="o">=</span><span class="default_value">'?'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.remove_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.remove_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove specified peak(s) from the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list.</p>
<p>Select the peak(s) to be removed by specifying either the respective
<cite>peak_indeces</cite>, <cite>species</cite> label(s) or peak marker position(s) <cite>x_pos</cite>.
To remove multiple peaks at once, pass a list to one of the above
arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peak_indeces</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>list of int</em><em>, </em><em>optional</em>) – Indeces of peak(s) to remove from the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list
(0-based!).</p></li>
<li><p><strong>x_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><em>list of float</em><em> [</em><em>u</em><em>]</em>) – <code class="xref py py-attr docutils literal notranslate"><span class="pre">x_pos</span></code> of peak(s) to remove from the spectrum’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code>
list. Peak marker positions must be specified up to the 6th decimal.</p></li>
<li><p><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><em>list of str</em>) – <code class="xref py py-attr docutils literal notranslate"><span class="pre">species</span></code> label(s) of peak(s) to remove from the spectrum’s
<code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The current <code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list can be viewed by calling the
<a class="reference internal" href="#emgfit.spectrum.spectrum.show_peak_properties" title="emgfit.spectrum.spectrum.show_peak_properties"><code class="xref py py-meth docutils literal notranslate"><span class="pre">show_peak_properties()</span></code></a> spectrum method.</p>
<p>Added in version 0.2.0 (as successor method to <cite>remove_peak</cite>)</p>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.save_peak_shape_cal">
<code class="sig-name descname">save_peak_shape_cal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.save_peak_shape_cal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.save_peak_shape_cal" title="Permalink to this definition">¶</a></dt>
<dd><p>Save peak shape parameters to a TXT-file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Name of output file (‘.txt’ extension is automatically appended).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.save_results">
<code class="sig-name descname">save_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">save_plots</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.save_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.save_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the fit results to a XLSX file and the peak-shape calibration
to a TXT file.</p>
<p>Write results to an XLSX Excel file named <cite>&lt;filename&gt;_results.xlsx</cite>
and save peak-shape calibration parameters to TXT file named
<cite>&lt;filename&gt;_peakshape_calib.txt</cite>.</p>
<p>The EXCEL file contains the following three worksheets:</p>
<ul class="simple">
<li><p>general spectrum properties</p></li>
<li><p>peak properties and images of all obtained fit curves</p></li>
<li><p>results of the regular peakshape-error evaluation in which shape
parameters are varied by +-1 sigma</p></li>
</ul>
<p>By default, PNG images of all peak fits are saved to PNG-images in both
linear and logarithmic scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – Prefix of the files to be saved to (any provided file extensions are
automatically removed and the necessary .xlsx &amp; .txt extensions are
appended).</p></li>
<li><p><strong>save_plots</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to save images of all obtained fit curves to separate PNG
files (default: <cite>True</cite>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.set_blinded_peaks">
<code class="sig-name descname">set_blinded_peaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">indeces</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.set_blinded_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.set_blinded_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify for which peaks mass values will be hidden for blind analysis</p>
<p>This method adds peaks to the spectrum’s list of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">blinded_peaks</span></code>. For these peaks, the
obtained mass values in the peak properties table and the peak position
parameters <cite>mu</cite> in fit reports will be hidden. Literature values and
mass uncertainties remain visible. All results are unblinded upon
export with the <a class="reference internal" href="#emgfit.spectrum.spectrum.save_results" title="emgfit.spectrum.spectrum.save_results"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_results()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indeces</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><em>list of int</em>) – Indeces of peaks of interest whose obtained mass values are to be
blinded.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em><em>, </em><em>default: False</em>) – If <cite>False</cite> (default), the specified <cite>indeces</cite> are added to the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">blinded_peaks</span></code> list. If <cite>True</cite>, the current
<code class="xref py py-attr docutils literal notranslate"><span class="pre">blinded_peaks</span></code> list is replaced by the specified <cite>indeces</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Activate blinding for peaks 0 &amp; 3 of spectrum object <cite>spec</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">set_blinded_peaks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>Add peak 3 to list of blinded peaks:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">set_blinded_peaks</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>Turn off blinding by resetting the blinded peaks attribute to an empty
list:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span><span class="o">.</span><span class="n">set_blinded_peaks</span><span class="p">([],</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="emgfit.spectrum.spectrum.show_peak_properties">
<code class="sig-name descname">show_peak_properties</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/emgfit/spectrum.html#spectrum.show_peak_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emgfit.spectrum.spectrum.show_peak_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Print properties of all peaks in <code class="xref py py-attr docutils literal notranslate"><span class="pre">peaks</span></code> list.</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="release-history.html" class="btn btn-neutral float-right" title="Release History" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="concepts.html" class="btn btn-neutral float-left" title="Central concepts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Stefan Paul

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>